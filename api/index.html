
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Documentation website for causalprog">
      
      
        <meta name="author" content="Collaborations team, UCL Centre for Advanced Research Computing">
      
      
      
        <link rel="prev" href="../developers/tests/">
      
      
        <link rel="next" href="../LICENSE/">
      
      
      <link rel="icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.20">
    
    
      
        <title>API reference - causalprog</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.e53b48f4.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../assets/_mkdocstrings.css">
    
    <script>__md_scope=new URL("..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#api-reference" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="causalprog" class="md-header__button md-logo" aria-label="causalprog" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            causalprog
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              API reference
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/UCL/causalprog/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    UCL/causalprog
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="causalprog" class="md-nav__button md-logo" aria-label="causalprog" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    causalprog
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/UCL/causalprog/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
  </div>
  <div class="md-source__repository">
    UCL/causalprog
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Overview
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Theory
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Theory
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../theory/mathematical-context/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Mathematical context
    
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../theory/simple-working-example/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Simple working example
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  
  <span class="md-ellipsis">
    Developers
    
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Developers
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../developers/tests/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Testing suite
    
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    API reference
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    API reference
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#causalprog" class="md-nav__link">
    <span class="md-ellipsis">
      causalprog
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#causalprog.algorithms" class="md-nav__link">
    <span class="md-ellipsis">
      algorithms
    </span>
  </a>
  
    <nav class="md-nav" aria-label="algorithms">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#causalprog.algorithms.do" class="md-nav__link">
    <span class="md-ellipsis">
      do
    </span>
  </a>
  
    <nav class="md-nav" aria-label="do">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#causalprog.algorithms.do.do" class="md-nav__link">
    <span class="md-ellipsis">
      do
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalprog.algorithms.do.get_included_excluded_successors" class="md-nav__link">
    <span class="md-ellipsis">
      get_included_excluded_successors
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalprog.algorithms.do.removable_nodes" class="md-nav__link">
    <span class="md-ellipsis">
      removable_nodes
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalprog.algorithms.moments" class="md-nav__link">
    <span class="md-ellipsis">
      moments
    </span>
  </a>
  
    <nav class="md-nav" aria-label="moments">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#causalprog.algorithms.moments.expectation" class="md-nav__link">
    <span class="md-ellipsis">
      expectation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalprog.algorithms.moments.moment" class="md-nav__link">
    <span class="md-ellipsis">
      moment
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalprog.algorithms.moments.sample" class="md-nav__link">
    <span class="md-ellipsis">
      sample
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalprog.algorithms.moments.standard_deviation" class="md-nav__link">
    <span class="md-ellipsis">
      standard_deviation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#causalprog.backend" class="md-nav__link">
    <span class="md-ellipsis">
      backend
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#causalprog.causal_problem" class="md-nav__link">
    <span class="md-ellipsis">
      causal_problem
    </span>
  </a>
  
    <nav class="md-nav" aria-label="causal_problem">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#causalprog.causal_problem.CausalEstimand" class="md-nav__link">
    <span class="md-ellipsis">
      CausalEstimand
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalprog.causal_problem.CausalProblem" class="md-nav__link">
    <span class="md-ellipsis">
      CausalProblem
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CausalProblem">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#causalprog.causal_problem.CausalProblem.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalprog.causal_problem.CausalProblem.lagrangian" class="md-nav__link">
    <span class="md-ellipsis">
      lagrangian
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalprog.causal_problem.Constraint" class="md-nav__link">
    <span class="md-ellipsis">
      Constraint
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Constraint">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#causalprog.causal_problem.Constraint.__call__" class="md-nav__link">
    <span class="md-ellipsis">
      __call__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalprog.causal_problem.Constraint.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalprog.causal_problem.HandlerToApply" class="md-nav__link">
    <span class="md-ellipsis">
      HandlerToApply
    </span>
  </a>
  
    <nav class="md-nav" aria-label="HandlerToApply">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#causalprog.causal_problem.HandlerToApply.__eq__" class="md-nav__link">
    <span class="md-ellipsis">
      __eq__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalprog.causal_problem.HandlerToApply.__post_init__" class="md-nav__link">
    <span class="md-ellipsis">
      __post_init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalprog.causal_problem.HandlerToApply.from_pair" class="md-nav__link">
    <span class="md-ellipsis">
      from_pair
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalprog.causal_problem.causal_problem" class="md-nav__link">
    <span class="md-ellipsis">
      causal_problem
    </span>
  </a>
  
    <nav class="md-nav" aria-label="causal_problem">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#causalprog.causal_problem.causal_problem.CausalProblem" class="md-nav__link">
    <span class="md-ellipsis">
      CausalProblem
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CausalProblem">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#causalprog.causal_problem.causal_problem.CausalProblem.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalprog.causal_problem.causal_problem.CausalProblem.lagrangian" class="md-nav__link">
    <span class="md-ellipsis">
      lagrangian
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalprog.causal_problem.causal_problem.sample_model" class="md-nav__link">
    <span class="md-ellipsis">
      sample_model
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalprog.causal_problem.components" class="md-nav__link">
    <span class="md-ellipsis">
      components
    </span>
  </a>
  
    <nav class="md-nav" aria-label="components">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#causalprog.causal_problem.components.CausalEstimand" class="md-nav__link">
    <span class="md-ellipsis">
      CausalEstimand
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalprog.causal_problem.components.Constraint" class="md-nav__link">
    <span class="md-ellipsis">
      Constraint
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Constraint">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#causalprog.causal_problem.components.Constraint.__call__" class="md-nav__link">
    <span class="md-ellipsis">
      __call__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalprog.causal_problem.components.Constraint.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalprog.causal_problem.handlers" class="md-nav__link">
    <span class="md-ellipsis">
      handlers
    </span>
  </a>
  
    <nav class="md-nav" aria-label="handlers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#causalprog.causal_problem.handlers.HandlerToApply" class="md-nav__link">
    <span class="md-ellipsis">
      HandlerToApply
    </span>
  </a>
  
    <nav class="md-nav" aria-label="HandlerToApply">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#causalprog.causal_problem.handlers.HandlerToApply.__eq__" class="md-nav__link">
    <span class="md-ellipsis">
      __eq__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalprog.causal_problem.handlers.HandlerToApply.__post_init__" class="md-nav__link">
    <span class="md-ellipsis">
      __post_init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalprog.causal_problem.handlers.HandlerToApply.from_pair" class="md-nav__link">
    <span class="md-ellipsis">
      from_pair
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#causalprog.graph" class="md-nav__link">
    <span class="md-ellipsis">
      graph
    </span>
  </a>
  
    <nav class="md-nav" aria-label="graph">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#causalprog.graph.graph" class="md-nav__link">
    <span class="md-ellipsis">
      graph
    </span>
  </a>
  
    <nav class="md-nav" aria-label="graph">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#causalprog.graph.graph.Graph" class="md-nav__link">
    <span class="md-ellipsis">
      Graph
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Graph">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#causalprog.graph.graph.Graph.edges" class="md-nav__link">
    <span class="md-ellipsis">
      edges
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalprog.graph.graph.Graph.nodes" class="md-nav__link">
    <span class="md-ellipsis">
      nodes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalprog.graph.graph.Graph.ordered_dist_nodes" class="md-nav__link">
    <span class="md-ellipsis">
      ordered_dist_nodes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalprog.graph.graph.Graph.ordered_nodes" class="md-nav__link">
    <span class="md-ellipsis">
      ordered_nodes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalprog.graph.graph.Graph.parameter_nodes" class="md-nav__link">
    <span class="md-ellipsis">
      parameter_nodes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalprog.graph.graph.Graph.predecessors" class="md-nav__link">
    <span class="md-ellipsis">
      predecessors
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalprog.graph.graph.Graph.successors" class="md-nav__link">
    <span class="md-ellipsis">
      successors
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalprog.graph.graph.Graph.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalprog.graph.graph.Graph.add_edge" class="md-nav__link">
    <span class="md-ellipsis">
      add_edge
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalprog.graph.graph.Graph.add_node" class="md-nav__link">
    <span class="md-ellipsis">
      add_node
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalprog.graph.graph.Graph.get_node" class="md-nav__link">
    <span class="md-ellipsis">
      get_node
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalprog.graph.graph.Graph.model" class="md-nav__link">
    <span class="md-ellipsis">
      model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalprog.graph.graph.Graph.roots_down_to_outcome" class="md-nav__link">
    <span class="md-ellipsis">
      roots_down_to_outcome
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalprog.graph.node" class="md-nav__link">
    <span class="md-ellipsis">
      node
    </span>
  </a>
  
    <nav class="md-nav" aria-label="node">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#causalprog.graph.node.base" class="md-nav__link">
    <span class="md-ellipsis">
      base
    </span>
  </a>
  
    <nav class="md-nav" aria-label="base">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#causalprog.graph.node.base.Node" class="md-nav__link">
    <span class="md-ellipsis">
      Node
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Node">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#causalprog.graph.node.base.Node.constant_parameters" class="md-nav__link">
    <span class="md-ellipsis">
      constant_parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalprog.graph.node.base.Node.is_distribution" class="md-nav__link">
    <span class="md-ellipsis">
      is_distribution
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalprog.graph.node.base.Node.is_parameter" class="md-nav__link">
    <span class="md-ellipsis">
      is_parameter
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalprog.graph.node.base.Node.parameters" class="md-nav__link">
    <span class="md-ellipsis">
      parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalprog.graph.node.base.Node.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalprog.graph.node.base.Node.copy" class="md-nav__link">
    <span class="md-ellipsis">
      copy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalprog.graph.node.base.Node.sample" class="md-nav__link">
    <span class="md-ellipsis">
      sample
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalprog.graph.node.distribution" class="md-nav__link">
    <span class="md-ellipsis">
      distribution
    </span>
  </a>
  
    <nav class="md-nav" aria-label="distribution">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#causalprog.graph.node.distribution.DistributionNode" class="md-nav__link">
    <span class="md-ellipsis">
      DistributionNode
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DistributionNode">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#causalprog.graph.node.distribution.DistributionNode.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalprog.graph.node.distribution.DistributionNode.create_model_site" class="md-nav__link">
    <span class="md-ellipsis">
      create_model_site
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalprog.graph.node.parameter" class="md-nav__link">
    <span class="md-ellipsis">
      parameter
    </span>
  </a>
  
    <nav class="md-nav" aria-label="parameter">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#causalprog.graph.node.parameter.ParameterNode" class="md-nav__link">
    <span class="md-ellipsis">
      ParameterNode
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ParameterNode">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#causalprog.graph.node.parameter.ParameterNode.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#causalprog.solvers" class="md-nav__link">
    <span class="md-ellipsis">
      solvers
    </span>
  </a>
  
    <nav class="md-nav" aria-label="solvers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#causalprog.solvers.sgd" class="md-nav__link">
    <span class="md-ellipsis">
      sgd
    </span>
  </a>
  
    <nav class="md-nav" aria-label="sgd">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#causalprog.solvers.sgd.stochastic_gradient_descent" class="md-nav__link">
    <span class="md-ellipsis">
      stochastic_gradient_descent
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalprog.solvers.solver_result" class="md-nav__link">
    <span class="md-ellipsis">
      solver_result
    </span>
  </a>
  
    <nav class="md-nav" aria-label="solver_result">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#causalprog.solvers.solver_result.SolverResult" class="md-nav__link">
    <span class="md-ellipsis">
      SolverResult
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#causalprog.utils" class="md-nav__link">
    <span class="md-ellipsis">
      utils
    </span>
  </a>
  
    <nav class="md-nav" aria-label="utils">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#causalprog.utils.norms" class="md-nav__link">
    <span class="md-ellipsis">
      norms
    </span>
  </a>
  
    <nav class="md-nav" aria-label="norms">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#causalprog.utils.norms.l2_normsq" class="md-nav__link">
    <span class="md-ellipsis">
      l2_normsq
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalprog.utils.translator" class="md-nav__link">
    <span class="md-ellipsis">
      translator
    </span>
  </a>
  
    <nav class="md-nav" aria-label="translator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#causalprog.utils.translator.Translator" class="md-nav__link">
    <span class="md-ellipsis">
      Translator
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Translator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#causalprog.utils.translator.Translator.compulsory_backend_args" class="md-nav__link">
    <span class="md-ellipsis">
      compulsory_backend_args
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalprog.utils.translator.Translator.compulsory_frontend_args" class="md-nav__link">
    <span class="md-ellipsis">
      compulsory_frontend_args
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalprog.utils.translator.Translator.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalprog.utils.translator.Translator.translate_args" class="md-nav__link">
    <span class="md-ellipsis">
      translate_args
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalprog.utils.translator.Translator.validate_compatible" class="md-nav__link">
    <span class="md-ellipsis">
      validate_compatible
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../LICENSE/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    License
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#causalprog" class="md-nav__link">
    <span class="md-ellipsis">
      causalprog
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#causalprog.algorithms" class="md-nav__link">
    <span class="md-ellipsis">
      algorithms
    </span>
  </a>
  
    <nav class="md-nav" aria-label="algorithms">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#causalprog.algorithms.do" class="md-nav__link">
    <span class="md-ellipsis">
      do
    </span>
  </a>
  
    <nav class="md-nav" aria-label="do">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#causalprog.algorithms.do.do" class="md-nav__link">
    <span class="md-ellipsis">
      do
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalprog.algorithms.do.get_included_excluded_successors" class="md-nav__link">
    <span class="md-ellipsis">
      get_included_excluded_successors
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalprog.algorithms.do.removable_nodes" class="md-nav__link">
    <span class="md-ellipsis">
      removable_nodes
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalprog.algorithms.moments" class="md-nav__link">
    <span class="md-ellipsis">
      moments
    </span>
  </a>
  
    <nav class="md-nav" aria-label="moments">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#causalprog.algorithms.moments.expectation" class="md-nav__link">
    <span class="md-ellipsis">
      expectation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalprog.algorithms.moments.moment" class="md-nav__link">
    <span class="md-ellipsis">
      moment
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalprog.algorithms.moments.sample" class="md-nav__link">
    <span class="md-ellipsis">
      sample
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalprog.algorithms.moments.standard_deviation" class="md-nav__link">
    <span class="md-ellipsis">
      standard_deviation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#causalprog.backend" class="md-nav__link">
    <span class="md-ellipsis">
      backend
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#causalprog.causal_problem" class="md-nav__link">
    <span class="md-ellipsis">
      causal_problem
    </span>
  </a>
  
    <nav class="md-nav" aria-label="causal_problem">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#causalprog.causal_problem.CausalEstimand" class="md-nav__link">
    <span class="md-ellipsis">
      CausalEstimand
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalprog.causal_problem.CausalProblem" class="md-nav__link">
    <span class="md-ellipsis">
      CausalProblem
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CausalProblem">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#causalprog.causal_problem.CausalProblem.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalprog.causal_problem.CausalProblem.lagrangian" class="md-nav__link">
    <span class="md-ellipsis">
      lagrangian
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalprog.causal_problem.Constraint" class="md-nav__link">
    <span class="md-ellipsis">
      Constraint
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Constraint">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#causalprog.causal_problem.Constraint.__call__" class="md-nav__link">
    <span class="md-ellipsis">
      __call__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalprog.causal_problem.Constraint.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalprog.causal_problem.HandlerToApply" class="md-nav__link">
    <span class="md-ellipsis">
      HandlerToApply
    </span>
  </a>
  
    <nav class="md-nav" aria-label="HandlerToApply">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#causalprog.causal_problem.HandlerToApply.__eq__" class="md-nav__link">
    <span class="md-ellipsis">
      __eq__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalprog.causal_problem.HandlerToApply.__post_init__" class="md-nav__link">
    <span class="md-ellipsis">
      __post_init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalprog.causal_problem.HandlerToApply.from_pair" class="md-nav__link">
    <span class="md-ellipsis">
      from_pair
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalprog.causal_problem.causal_problem" class="md-nav__link">
    <span class="md-ellipsis">
      causal_problem
    </span>
  </a>
  
    <nav class="md-nav" aria-label="causal_problem">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#causalprog.causal_problem.causal_problem.CausalProblem" class="md-nav__link">
    <span class="md-ellipsis">
      CausalProblem
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CausalProblem">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#causalprog.causal_problem.causal_problem.CausalProblem.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalprog.causal_problem.causal_problem.CausalProblem.lagrangian" class="md-nav__link">
    <span class="md-ellipsis">
      lagrangian
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalprog.causal_problem.causal_problem.sample_model" class="md-nav__link">
    <span class="md-ellipsis">
      sample_model
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalprog.causal_problem.components" class="md-nav__link">
    <span class="md-ellipsis">
      components
    </span>
  </a>
  
    <nav class="md-nav" aria-label="components">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#causalprog.causal_problem.components.CausalEstimand" class="md-nav__link">
    <span class="md-ellipsis">
      CausalEstimand
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalprog.causal_problem.components.Constraint" class="md-nav__link">
    <span class="md-ellipsis">
      Constraint
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Constraint">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#causalprog.causal_problem.components.Constraint.__call__" class="md-nav__link">
    <span class="md-ellipsis">
      __call__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalprog.causal_problem.components.Constraint.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalprog.causal_problem.handlers" class="md-nav__link">
    <span class="md-ellipsis">
      handlers
    </span>
  </a>
  
    <nav class="md-nav" aria-label="handlers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#causalprog.causal_problem.handlers.HandlerToApply" class="md-nav__link">
    <span class="md-ellipsis">
      HandlerToApply
    </span>
  </a>
  
    <nav class="md-nav" aria-label="HandlerToApply">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#causalprog.causal_problem.handlers.HandlerToApply.__eq__" class="md-nav__link">
    <span class="md-ellipsis">
      __eq__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalprog.causal_problem.handlers.HandlerToApply.__post_init__" class="md-nav__link">
    <span class="md-ellipsis">
      __post_init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalprog.causal_problem.handlers.HandlerToApply.from_pair" class="md-nav__link">
    <span class="md-ellipsis">
      from_pair
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#causalprog.graph" class="md-nav__link">
    <span class="md-ellipsis">
      graph
    </span>
  </a>
  
    <nav class="md-nav" aria-label="graph">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#causalprog.graph.graph" class="md-nav__link">
    <span class="md-ellipsis">
      graph
    </span>
  </a>
  
    <nav class="md-nav" aria-label="graph">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#causalprog.graph.graph.Graph" class="md-nav__link">
    <span class="md-ellipsis">
      Graph
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Graph">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#causalprog.graph.graph.Graph.edges" class="md-nav__link">
    <span class="md-ellipsis">
      edges
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalprog.graph.graph.Graph.nodes" class="md-nav__link">
    <span class="md-ellipsis">
      nodes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalprog.graph.graph.Graph.ordered_dist_nodes" class="md-nav__link">
    <span class="md-ellipsis">
      ordered_dist_nodes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalprog.graph.graph.Graph.ordered_nodes" class="md-nav__link">
    <span class="md-ellipsis">
      ordered_nodes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalprog.graph.graph.Graph.parameter_nodes" class="md-nav__link">
    <span class="md-ellipsis">
      parameter_nodes
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalprog.graph.graph.Graph.predecessors" class="md-nav__link">
    <span class="md-ellipsis">
      predecessors
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalprog.graph.graph.Graph.successors" class="md-nav__link">
    <span class="md-ellipsis">
      successors
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalprog.graph.graph.Graph.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalprog.graph.graph.Graph.add_edge" class="md-nav__link">
    <span class="md-ellipsis">
      add_edge
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalprog.graph.graph.Graph.add_node" class="md-nav__link">
    <span class="md-ellipsis">
      add_node
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalprog.graph.graph.Graph.get_node" class="md-nav__link">
    <span class="md-ellipsis">
      get_node
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalprog.graph.graph.Graph.model" class="md-nav__link">
    <span class="md-ellipsis">
      model
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalprog.graph.graph.Graph.roots_down_to_outcome" class="md-nav__link">
    <span class="md-ellipsis">
      roots_down_to_outcome
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalprog.graph.node" class="md-nav__link">
    <span class="md-ellipsis">
      node
    </span>
  </a>
  
    <nav class="md-nav" aria-label="node">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#causalprog.graph.node.base" class="md-nav__link">
    <span class="md-ellipsis">
      base
    </span>
  </a>
  
    <nav class="md-nav" aria-label="base">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#causalprog.graph.node.base.Node" class="md-nav__link">
    <span class="md-ellipsis">
      Node
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Node">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#causalprog.graph.node.base.Node.constant_parameters" class="md-nav__link">
    <span class="md-ellipsis">
      constant_parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalprog.graph.node.base.Node.is_distribution" class="md-nav__link">
    <span class="md-ellipsis">
      is_distribution
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalprog.graph.node.base.Node.is_parameter" class="md-nav__link">
    <span class="md-ellipsis">
      is_parameter
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalprog.graph.node.base.Node.parameters" class="md-nav__link">
    <span class="md-ellipsis">
      parameters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalprog.graph.node.base.Node.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalprog.graph.node.base.Node.copy" class="md-nav__link">
    <span class="md-ellipsis">
      copy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalprog.graph.node.base.Node.sample" class="md-nav__link">
    <span class="md-ellipsis">
      sample
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalprog.graph.node.distribution" class="md-nav__link">
    <span class="md-ellipsis">
      distribution
    </span>
  </a>
  
    <nav class="md-nav" aria-label="distribution">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#causalprog.graph.node.distribution.DistributionNode" class="md-nav__link">
    <span class="md-ellipsis">
      DistributionNode
    </span>
  </a>
  
    <nav class="md-nav" aria-label="DistributionNode">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#causalprog.graph.node.distribution.DistributionNode.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalprog.graph.node.distribution.DistributionNode.create_model_site" class="md-nav__link">
    <span class="md-ellipsis">
      create_model_site
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalprog.graph.node.parameter" class="md-nav__link">
    <span class="md-ellipsis">
      parameter
    </span>
  </a>
  
    <nav class="md-nav" aria-label="parameter">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#causalprog.graph.node.parameter.ParameterNode" class="md-nav__link">
    <span class="md-ellipsis">
      ParameterNode
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ParameterNode">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#causalprog.graph.node.parameter.ParameterNode.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#causalprog.solvers" class="md-nav__link">
    <span class="md-ellipsis">
      solvers
    </span>
  </a>
  
    <nav class="md-nav" aria-label="solvers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#causalprog.solvers.sgd" class="md-nav__link">
    <span class="md-ellipsis">
      sgd
    </span>
  </a>
  
    <nav class="md-nav" aria-label="sgd">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#causalprog.solvers.sgd.stochastic_gradient_descent" class="md-nav__link">
    <span class="md-ellipsis">
      stochastic_gradient_descent
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalprog.solvers.solver_result" class="md-nav__link">
    <span class="md-ellipsis">
      solver_result
    </span>
  </a>
  
    <nav class="md-nav" aria-label="solver_result">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#causalprog.solvers.solver_result.SolverResult" class="md-nav__link">
    <span class="md-ellipsis">
      SolverResult
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#causalprog.utils" class="md-nav__link">
    <span class="md-ellipsis">
      utils
    </span>
  </a>
  
    <nav class="md-nav" aria-label="utils">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#causalprog.utils.norms" class="md-nav__link">
    <span class="md-ellipsis">
      norms
    </span>
  </a>
  
    <nav class="md-nav" aria-label="norms">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#causalprog.utils.norms.l2_normsq" class="md-nav__link">
    <span class="md-ellipsis">
      l2_normsq
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalprog.utils.translator" class="md-nav__link">
    <span class="md-ellipsis">
      translator
    </span>
  </a>
  
    <nav class="md-nav" aria-label="translator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#causalprog.utils.translator.Translator" class="md-nav__link">
    <span class="md-ellipsis">
      Translator
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Translator">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#causalprog.utils.translator.Translator.compulsory_backend_args" class="md-nav__link">
    <span class="md-ellipsis">
      compulsory_backend_args
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalprog.utils.translator.Translator.compulsory_frontend_args" class="md-nav__link">
    <span class="md-ellipsis">
      compulsory_frontend_args
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalprog.utils.translator.Translator.__init__" class="md-nav__link">
    <span class="md-ellipsis">
      __init__
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalprog.utils.translator.Translator.translate_args" class="md-nav__link">
    <span class="md-ellipsis">
      translate_args
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#causalprog.utils.translator.Translator.validate_compatible" class="md-nav__link">
    <span class="md-ellipsis">
      validate_compatible
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
    <a href="https://github.com/UCL/causalprog/edit/main/docs/api.md" title="Edit this page" class="md-content__button md-icon" rel="edit">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M10 20H6V4h7v5h5v3.1l2-2V8l-6-6H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h4zm10.2-7c.1 0 .3.1.4.2l1.3 1.3c.2.2.2.6 0 .8l-1 1-2.1-2.1 1-1c.1-.1.2-.2.4-.2m0 3.9L14.1 23H12v-2.1l6.1-6.1z"/></svg>
    </a>
  
  


<h1 id="api-reference">API reference</h1>


<div class="doc doc-object doc-module">



<a id="causalprog"></a>
    <div class="doc doc-contents first">

        <p>causalprog package.</p>










  <div class="doc doc-children">











<div class="doc doc-object doc-module">



<h2 id="causalprog.algorithms" class="doc doc-heading">
            <code>algorithms</code>


</h2>

    <div class="doc doc-contents ">

        <p>Algorithms.</p>










  <div class="doc doc-children">











<div class="doc doc-object doc-module">



<h3 id="causalprog.algorithms.do" class="doc doc-heading">
            <code>do</code>


</h3>

    <div class="doc doc-contents ">

        <p>Algorithms for applying do to a graph.</p>










  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="causalprog.algorithms.do.do" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">do</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">node</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Apply do to a graph.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>graph</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Graph (causalprog.graph.Graph)" href="#causalprog.graph.graph.Graph">Graph</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The graph to apply do to. This will be copied.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>node</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The label of the node to apply do to.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>value</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The value to set the node to.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>label</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The label of the new graph</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="Graph (causalprog.graph.Graph)" href="#causalprog.graph.graph.Graph">Graph</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A copy of the graph with do applied</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/causalprog/algorithms/do.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">do</span><span class="p">(</span><span class="n">graph</span><span class="p">:</span> <span class="n">Graph</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">value</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span> <span class="n">label</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Graph</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Apply do to a graph.</span>

<span class="sd">    Args:</span>
<span class="sd">        graph: The graph to apply do to. This will be copied.</span>
<span class="sd">        node: The label of the node to apply do to.</span>
<span class="sd">        value: The value to set the node to.</span>
<span class="sd">        label: The label of the new graph</span>

<span class="sd">    Returns:</span>
<span class="sd">        A copy of the graph with do applied</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">label</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">label</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">graph</span><span class="o">.</span><span class="n">label</span><span class="si">}</span><span class="s2">|do(</span><span class="si">{</span><span class="n">node</span><span class="si">}</span><span class="s2">=</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">)&quot;</span>

    <span class="n">nodes</span> <span class="o">=</span> <span class="p">{</span><span class="n">n</span><span class="o">.</span><span class="n">label</span><span class="p">:</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">n</span><span class="p">)</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">nodes</span> <span class="k">if</span> <span class="n">n</span><span class="o">.</span><span class="n">label</span> <span class="o">!=</span> <span class="n">node</span><span class="p">}</span>

    <span class="c1"># Search through the old graph, identifying nodes that had parameters which were</span>
    <span class="c1"># defined by the node being fixed in the DO operation.</span>
    <span class="c1"># We recreate these nodes, but replace each such parameter we encounter with</span>
    <span class="c1"># a constant parameter equal that takes the fixed value given as an input.</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">nodes</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
        <span class="n">params</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">n</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>
        <span class="k">for</span> <span class="n">parameter_name</span> <span class="ow">in</span> <span class="n">params</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">n</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="n">parameter_name</span><span class="p">]</span> <span class="o">==</span> <span class="n">node</span><span class="p">:</span>
                <span class="c1"># Swap the parameter to a constant parameter, giving it the fixed value</span>
                <span class="n">n</span><span class="o">.</span><span class="n">constant_parameters</span><span class="p">[</span><span class="n">parameter_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
                <span class="c1"># Remove the parameter from the node&#39;s record of non-constant parameters</span>
                <span class="n">n</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">parameter_name</span><span class="p">)</span>

    <span class="c1"># Recursively remove nodes that are predecessors of removed nodes</span>
    <span class="n">nodes_to_remove</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">node</span><span class="p">,)</span>
    <span class="k">while</span> <span class="nb">len</span><span class="p">(</span><span class="n">nodes_to_remove</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">nodes_to_remove</span> <span class="o">=</span> <span class="n">removable_nodes</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">nodes</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">removable_nodes</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">nodes</span><span class="p">):</span>
            <span class="n">nodes</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>

    <span class="c1"># Check for nodes that are predecessors of both a removed node and a remaining node</span>
    <span class="c1"># and throw an error if one of these is found</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">nodes</span><span class="p">:</span>
        <span class="n">_</span><span class="p">,</span> <span class="n">excluded</span> <span class="o">=</span> <span class="n">get_included_excluded_successors</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">nodes</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">excluded</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span>
                <span class="s2">&quot;Node that is predecessor of node set by do and &quot;</span>
                <span class="sa">f</span><span class="s1">&#39;nodes that are not removed found (&quot;</span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s1">&quot;)&#39;</span>
            <span class="p">)</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

    <span class="n">g</span> <span class="o">=</span> <span class="n">Graph</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s2">|do[</span><span class="si">{</span><span class="n">node</span><span class="si">}</span><span class="s2">=</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">]&quot;</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">nodes</span><span class="o">.</span><span class="n">values</span><span class="p">():</span>
        <span class="n">g</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>

    <span class="c1"># Any nodes whose counterparts connect to other nodes in the network need</span>
    <span class="c1"># to mimic these links.</span>
    <span class="k">for</span> <span class="n">edge</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">edges</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">edge</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">label</span> <span class="ow">in</span> <span class="n">nodes</span> <span class="ow">and</span> <span class="n">edge</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">label</span> <span class="ow">in</span> <span class="n">nodes</span><span class="p">:</span>
            <span class="n">g</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">edge</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">label</span><span class="p">,</span> <span class="n">edge</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">label</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">g</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="causalprog.algorithms.do.get_included_excluded_successors" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_included_excluded_successors</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">node_list</span><span class="p">,</span> <span class="n">successors_of</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Split successors of a node into nodes included and not included in a list.</p>
<p>Split the successorts of a node into a list of nodes that are included in
the input node list and a list of nodes that are not in the list.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>graph</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Graph (causalprog.graph.Graph)" href="#causalprog.graph.graph.Graph">Graph</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The graph</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>node_list</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-internal" title="Node (causalprog.graph.Node)" href="#causalprog.graph.node.base.Node">Node</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary of nodes, indexed by label</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>successors_of</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The node to check the successors of</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#tuple">tuple</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#tuple">tuple</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, ...], <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#tuple">tuple</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, ...]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Lists of included and excluded nodes</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/causalprog/algorithms/do.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_included_excluded_successors</span><span class="p">(</span>
    <span class="n">graph</span><span class="p">:</span> <span class="n">Graph</span><span class="p">,</span> <span class="n">node_list</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Node</span><span class="p">],</span> <span class="n">successors_of</span><span class="p">:</span> <span class="nb">str</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="o">...</span><span class="p">],</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="o">...</span><span class="p">]]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Split successors of a node into nodes included and not included in a list.</span>

<span class="sd">    Split the successorts of a node into a list of nodes that are included in</span>
<span class="sd">    the input node list and a list of nodes that are not in the list.</span>

<span class="sd">    Args:</span>
<span class="sd">        graph: The graph</span>
<span class="sd">        node_list: A dictionary of nodes, indexed by label</span>
<span class="sd">        successors_of: The node to check the successors of</span>

<span class="sd">    Returns:</span>
<span class="sd">        Lists of included and excluded nodes</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">included</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">excluded</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">successors</span><span class="p">[</span><span class="n">graph</span><span class="o">.</span><span class="n">get_node</span><span class="p">(</span><span class="n">successors_of</span><span class="p">)]:</span>
        <span class="k">if</span> <span class="n">n</span><span class="o">.</span><span class="n">label</span> <span class="ow">in</span> <span class="n">node_list</span><span class="p">:</span>
            <span class="n">included</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">excluded</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">included</span><span class="p">),</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">excluded</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="causalprog.algorithms.do.removable_nodes" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">removable_nodes</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">nodes</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Generate list of nodes that can be removed from the graph.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>graph</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Graph (causalprog.graph.Graph)" href="#causalprog.graph.graph.Graph">Graph</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The graph</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>nodes</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-internal" title="Node (causalprog.graph.Node)" href="#causalprog.graph.node.base.Node">Node</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary of nodes, indexed by label</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#tuple">tuple</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, ...]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>List of labels of removable nodes</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/causalprog/algorithms/do.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">removable_nodes</span><span class="p">(</span><span class="n">graph</span><span class="p">:</span> <span class="n">Graph</span><span class="p">,</span> <span class="n">nodes</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Node</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="o">...</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Generate list of nodes that can be removed from the graph.</span>

<span class="sd">    Args:</span>
<span class="sd">        graph: The graph</span>
<span class="sd">        nodes: A dictionary of nodes, indexed by label</span>

<span class="sd">    Returns:</span>
<span class="sd">        List of labels of removable nodes</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">removable</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">str</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">nodes</span><span class="p">:</span>
        <span class="n">included</span><span class="p">,</span> <span class="n">excluded</span> <span class="o">=</span> <span class="n">get_included_excluded_successors</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">nodes</span><span class="p">,</span> <span class="n">n</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">excluded</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">included</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">removable</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">removable</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="causalprog.algorithms.moments" class="doc doc-heading">
            <code>moments</code>


</h3>

    <div class="doc doc-contents ">

        <p>Algorithms for estimating the expectation and standard deviation.</p>










  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="causalprog.algorithms.moments.expectation" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">expectation</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">outcome_node_label</span><span class="p">,</span> <span class="n">samples</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">parameter_values</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rng_key</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Estimate the expectation of (a random variable attached to) a node in a graph.</p>


            <details class="quote">
              <summary>Source code in <code>src/causalprog/algorithms/moments.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">expectation</span><span class="p">(</span>
    <span class="n">graph</span><span class="p">:</span> <span class="n">Graph</span><span class="p">,</span>
    <span class="n">outcome_node_label</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">samples</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">parameter_values</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">rng_key</span><span class="p">:</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Estimate the expectation of (a random variable attached to) a node in a graph.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">moment</span><span class="p">(</span>
        <span class="mi">1</span><span class="p">,</span>
        <span class="n">graph</span><span class="p">,</span>
        <span class="n">outcome_node_label</span><span class="p">,</span>
        <span class="n">samples</span><span class="p">,</span>
        <span class="n">rng_key</span><span class="o">=</span><span class="n">rng_key</span><span class="p">,</span>
        <span class="n">parameter_values</span><span class="o">=</span><span class="n">parameter_values</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="causalprog.algorithms.moments.moment" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">moment</span><span class="p">(</span><span class="n">order</span><span class="p">,</span> <span class="n">graph</span><span class="p">,</span> <span class="n">outcome_node_label</span><span class="p">,</span> <span class="n">samples</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">parameter_values</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rng_key</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Estimate a moment of (a random variable attached to) a node in a graph.</p>


            <details class="quote">
              <summary>Source code in <code>src/causalprog/algorithms/moments.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">moment</span><span class="p">(</span>
    <span class="n">order</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">graph</span><span class="p">:</span> <span class="n">Graph</span><span class="p">,</span>
    <span class="n">outcome_node_label</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">samples</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">parameter_values</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">rng_key</span><span class="p">:</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Estimate a moment of (a random variable attached to) a node in a graph.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="nb">sum</span><span class="p">(</span>
            <span class="n">sample</span><span class="p">(</span>
                <span class="n">graph</span><span class="p">,</span>
                <span class="n">outcome_node_label</span><span class="p">,</span>
                <span class="n">samples</span><span class="p">,</span>
                <span class="n">rng_key</span><span class="o">=</span><span class="n">rng_key</span><span class="p">,</span>
                <span class="n">parameter_values</span><span class="o">=</span><span class="n">parameter_values</span><span class="p">,</span>
            <span class="p">)</span>
            <span class="o">**</span> <span class="n">order</span>
        <span class="p">)</span>
        <span class="o">/</span> <span class="n">samples</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="causalprog.algorithms.moments.sample" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">sample</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">outcome_node_label</span><span class="p">,</span> <span class="n">samples</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">parameter_values</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rng_key</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Sample data from (a random variable attached to) a node in a graph.</p>


            <details class="quote">
              <summary>Source code in <code>src/causalprog/algorithms/moments.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">sample</span><span class="p">(</span>
    <span class="n">graph</span><span class="p">:</span> <span class="n">Graph</span><span class="p">,</span>
    <span class="n">outcome_node_label</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">samples</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">parameter_values</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">rng_key</span><span class="p">:</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Sample data from (a random variable attached to) a node in a graph.&quot;&quot;&quot;</span>
    <span class="n">nodes</span> <span class="o">=</span> <span class="n">graph</span><span class="o">.</span><span class="n">roots_down_to_outcome</span><span class="p">(</span><span class="n">outcome_node_label</span><span class="p">)</span>

    <span class="n">values</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="nb">float</span><span class="p">]]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">keys</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">rng_key</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">nodes</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">node</span><span class="p">,</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">nodes</span><span class="p">,</span> <span class="n">keys</span><span class="p">,</span> <span class="n">strict</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="n">values</span><span class="p">[</span><span class="n">node</span><span class="o">.</span><span class="n">label</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span>
            <span class="n">parameter_values</span> <span class="k">if</span> <span class="n">parameter_values</span> <span class="k">else</span> <span class="p">{},</span>
            <span class="n">values</span><span class="p">,</span>
            <span class="n">samples</span><span class="p">,</span>
            <span class="n">rng_key</span><span class="o">=</span><span class="n">key</span><span class="p">,</span>
        <span class="p">)</span>
    <span class="k">return</span> <span class="n">values</span><span class="p">[</span><span class="n">outcome_node_label</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="causalprog.algorithms.moments.standard_deviation" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">standard_deviation</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="n">outcome_node_label</span><span class="p">,</span> <span class="n">samples</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">parameter_values</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rng_key</span><span class="p">,</span> <span class="n">rng_key_first_moment</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Estimate the standard deviation of (a RV attached to) a node in a graph.</p>


            <details class="quote">
              <summary>Source code in <code>src/causalprog/algorithms/moments.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">standard_deviation</span><span class="p">(</span>
    <span class="n">graph</span><span class="p">:</span> <span class="n">Graph</span><span class="p">,</span>
    <span class="n">outcome_node_label</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">samples</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">parameter_values</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">rng_key</span><span class="p">:</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">,</span>
    <span class="n">rng_key_first_moment</span><span class="p">:</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Estimate the standard deviation of (a RV attached to) a node in a graph.&quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="n">moment</span><span class="p">(</span>
            <span class="mi">2</span><span class="p">,</span>
            <span class="n">graph</span><span class="p">,</span>
            <span class="n">outcome_node_label</span><span class="p">,</span>
            <span class="n">samples</span><span class="p">,</span>
            <span class="n">rng_key</span><span class="o">=</span><span class="n">rng_key</span><span class="p">,</span>
            <span class="n">parameter_values</span><span class="o">=</span><span class="n">parameter_values</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="o">-</span> <span class="n">moment</span><span class="p">(</span>
            <span class="mi">1</span><span class="p">,</span>
            <span class="n">graph</span><span class="p">,</span>
            <span class="n">outcome_node_label</span><span class="p">,</span>
            <span class="n">samples</span><span class="p">,</span>
            <span class="n">rng_key</span><span class="o">=</span><span class="n">rng_key</span> <span class="k">if</span> <span class="n">rng_key_first_moment</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">rng_key_first_moment</span><span class="p">,</span>
            <span class="n">parameter_values</span><span class="o">=</span><span class="n">parameter_values</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="o">**</span> <span class="mi">2</span>
    <span class="p">)</span> <span class="o">**</span> <span class="mf">0.5</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>


  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="causalprog.backend" class="doc doc-heading">
            <code>backend</code>


</h2>

    <div class="doc doc-contents ">

        <p>Helper functionality for incorporating different backends.</p>










  <div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="causalprog.causal_problem" class="doc doc-heading">
            <code>causal_problem</code>


</h2>

    <div class="doc doc-contents ">

        <p>Classes for defining causal problems.</p>










  <div class="doc doc-children">









<div class="doc doc-object doc-class">



<h3 id="causalprog.causal_problem.CausalEstimand" class="doc doc-heading">
            <code>CausalEstimand</code>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="causalprog.causal_problem._base_component._CPComponent">_CPComponent</span></code></p>


        <p>A Causal Estimand.</p>
<p>The causal estimand is the function that we want to minimise (and maximise)
as part of a causal problem. It should be a scalar-valued function of the
random variables appearing in a graph.</p>








              <details class="quote">
                <summary>Source code in <code>src/causalprog/causal_problem/components.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">CausalEstimand</span><span class="p">(</span><span class="n">_CPComponent</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A Causal Estimand.</span>

<span class="sd">    The causal estimand is the function that we want to minimise (and maximise)</span>
<span class="sd">    as part of a causal problem. It should be a scalar-valued function of the</span>
<span class="sd">    random variables appearing in a graph.</span>
<span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="causalprog.causal_problem.CausalProblem" class="doc doc-heading">
            <code>CausalProblem</code>


</h3>


    <div class="doc doc-contents ">


        <p>Defines a causal problem.</p>








              <details class="quote">
                <summary>Source code in <code>src/causalprog/causal_problem/causal_problem.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">CausalProblem</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Defines a causal problem.&quot;&quot;&quot;</span>

    <span class="n">_underlying_graph</span><span class="p">:</span> <span class="n">Graph</span>
    <span class="n">causal_estimand</span><span class="p">:</span> <span class="n">CausalEstimand</span>
    <span class="n">constraints</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Constraint</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_ordered_components</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">_CPComponent</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Internal ordering for components of the causal problem.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">constraints</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">causal_estimand</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">graph</span><span class="p">:</span> <span class="n">Graph</span><span class="p">,</span>
        <span class="o">*</span><span class="n">constraints</span><span class="p">:</span> <span class="n">Constraint</span><span class="p">,</span>
        <span class="n">causal_estimand</span><span class="p">:</span> <span class="n">CausalEstimand</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a new causal problem.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_underlying_graph</span> <span class="o">=</span> <span class="n">graph</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">causal_estimand</span> <span class="o">=</span> <span class="n">causal_estimand</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">constraints</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">constraints</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_associate_models_to_components</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">n_samples</span><span class="p">:</span> <span class="nb">int</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="n">Predictive</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create models to be used by components of the problem.</span>

<span class="sd">        Depending on how many constraints (and the causal estimand) require effect</span>
<span class="sd">        handlers to wrap `self._underlying_graph.model`, we will need to create several</span>
<span class="sd">        predictive models to sample from. However, we also want to minimise the number</span>
<span class="sd">        of such models we have to make, in order to minimise the time we spend</span>
<span class="sd">        actually computing samples.</span>

<span class="sd">        As such, in this method we determine:</span>
<span class="sd">        - How many models we will need to build, by grouping the constraints and the</span>
<span class="sd">          causal estimand by the handlers they use.</span>
<span class="sd">        - Build these models, returning them in a list called `models`.</span>
<span class="sd">        - Build another list that maps the index of components in</span>
<span class="sd">          `self._ordered_components` to the index of the model in `models` that they</span>
<span class="sd">          use. The causal estimand is by convention the component at index -1 of this</span>
<span class="sd">          returned list.</span>

<span class="sd">        Args:</span>
<span class="sd">            n_samples: Value to be passed to `numpyro.Predictive`&#39;s `num_samples`</span>
<span class="sd">                argument for each of the models that are constructed from the underlying</span>
<span class="sd">                graph.</span>

<span class="sd">        Returns:</span>
<span class="sd">            list[Predictive]: List of Predictive models, whose elements contain all the</span>
<span class="sd">                models needed by the components.</span>
<span class="sd">            list[int]: Mapping of component indexes (as per `self_ordered_components`)</span>
<span class="sd">                to the index of the model in the first return argument that the</span>
<span class="sd">                component uses.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">models</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Predictive</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">grouped_component_indexes</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">component</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ordered_components</span><span class="p">):</span>
            <span class="c1"># Determine if this constraint uses the same handlers as those of any of</span>
            <span class="c1"># the other sets.</span>
            <span class="n">belongs_to_existing_group</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">grouped_component_indexes</span><span class="p">:</span>
                <span class="c1"># Pull any element from the group to compare models to.</span>
                <span class="c1"># Items in a group are known to have the same model, so we can just</span>
                <span class="c1"># pull out the first one.</span>
                <span class="n">group_element</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ordered_components</span><span class="p">[</span><span class="n">group</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
                <span class="c1"># Check if the current constraint can also use this model.</span>
                <span class="k">if</span> <span class="n">component</span><span class="o">.</span><span class="n">can_use_same_model_as</span><span class="p">(</span><span class="n">group_element</span><span class="p">):</span>
                    <span class="n">group</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
                    <span class="n">belongs_to_existing_group</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="k">break</span>

            <span class="c1"># If the component does not fit into any existing group, create a new</span>
            <span class="c1"># group for it. And add the model corresponding to the group to the</span>
            <span class="c1"># list of models.</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">belongs_to_existing_group</span><span class="p">:</span>
                <span class="n">grouped_component_indexes</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">index</span><span class="p">])</span>

                <span class="n">models</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="n">Predictive</span><span class="p">(</span>
                        <span class="n">component</span><span class="o">.</span><span class="n">apply_effects</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_underlying_graph</span><span class="o">.</span><span class="n">model</span><span class="p">),</span>
                        <span class="n">num_samples</span><span class="o">=</span><span class="n">n_samples</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="p">)</span>

        <span class="c1"># Now &quot;invert&quot; the grouping, creating a mapping that maps the index of a</span>
        <span class="c1"># component to the (index of the) model it uses.</span>
        <span class="n">component_index_to_model_index</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ordered_components</span><span class="p">)):</span>
            <span class="k">for</span> <span class="n">group_index</span><span class="p">,</span> <span class="n">group</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">grouped_component_indexes</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">index</span> <span class="ow">in</span> <span class="n">group</span><span class="p">:</span>
                    <span class="n">component_index_to_model_index</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">group_index</span><span class="p">)</span>
                    <span class="k">break</span>
        <span class="c1"># All indexes should belong to at least one group (worst case scenario,</span>
        <span class="c1"># their own individual group). Thus, it is safe to do the above to create</span>
        <span class="c1"># the mapping from component index -&gt; model (group) index.</span>
        <span class="k">return</span> <span class="n">models</span><span class="p">,</span> <span class="n">component_index_to_model_index</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">lagrangian</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">n_samples</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">maximum_problem</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">npt</span><span class="o">.</span><span class="n">ArrayLike</span><span class="p">],</span> <span class="n">npt</span><span class="o">.</span><span class="n">ArrayLike</span><span class="p">,</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">],</span> <span class="n">npt</span><span class="o">.</span><span class="n">ArrayLike</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a function that evaluates the Lagrangian of this `CausalProblem`.</span>

<span class="sd">        Following the</span>
<span class="sd">        [KKT theorem](https://en.wikipedia.org/wiki/Karush%E2%80%93Kuhn%E2%80%93Tucker_conditions),</span>
<span class="sd">        given the causal estimand and the constraints we can assemble a Lagrangian and</span>
<span class="sd">        seek its stationary points, to in turn identify minimisers of the constrained</span>
<span class="sd">        optimisation problem that we started with.</span>

<span class="sd">        The Lagrangian returned is a mathematical function of its first two arguments.</span>
<span class="sd">        The first argument is the same dictionary of parameters that is passed to models</span>
<span class="sd">        like `Graph.model`, and is the values the parameters (represented by the</span>
<span class="sd">        `ParameterNode`s) are taking. The second argument is a 1D vector of Lagrange</span>
<span class="sd">        multipliers, whose length is equal to the number of constraints.</span>

<span class="sd">        The remaining argument of the Lagrangian is the PRNG Key that should be used</span>
<span class="sd">        when drawing samples.</span>

<span class="sd">        Note that our current implementation assumes there are no equality constraints</span>
<span class="sd">        being imposed (in which case, we would need a 3-argument Lagrangian function).</span>

<span class="sd">        Args:</span>
<span class="sd">            n_samples: The number of random samples to be drawn when estimating the</span>
<span class="sd">                value of functions of the RVs.</span>
<span class="sd">            maximum_problem: If passed as `True`, assemble the Lagrangian for the</span>
<span class="sd">                maximisation problem. Otherwise assemble that for the minimisation</span>
<span class="sd">                problem (default behaviour).</span>

<span class="sd">        Returns:</span>
<span class="sd">            The Lagrangian, as a function of the model parameters, Lagrange multipliers,</span>
<span class="sd">                and PRNG key.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">maximisation_prefactor</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span> <span class="k">if</span> <span class="n">maximum_problem</span> <span class="k">else</span> <span class="mf">1.0</span>

        <span class="c1"># Build association between self.constraints and the model-samples that each</span>
        <span class="c1"># one needs to use. We do this here, since once it is constructed, it is</span>
        <span class="c1"># fixed, and doesn&#39;t need to be done each time we call the Lagrangian.</span>
        <span class="n">models</span><span class="p">,</span> <span class="n">component_to_index_mapping</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_associate_models_to_components</span><span class="p">(</span>
            <span class="n">n_samples</span>
        <span class="p">)</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">_inner</span><span class="p">(</span>
            <span class="n">parameter_values</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">npt</span><span class="o">.</span><span class="n">ArrayLike</span><span class="p">],</span>
            <span class="n">l_mult</span><span class="p">:</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">,</span>
            <span class="n">rng_key</span><span class="p">:</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">,</span>
        <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">npt</span><span class="o">.</span><span class="n">ArrayLike</span><span class="p">:</span>
            <span class="c1"># Draw samples from all models</span>
            <span class="n">all_samples</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span>
                <span class="n">sample_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">rng_key</span><span class="p">,</span> <span class="n">parameter_values</span><span class="p">)</span> <span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">models</span>
            <span class="p">)</span>

            <span class="n">value</span> <span class="o">=</span> <span class="n">maximisation_prefactor</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">causal_estimand</span><span class="p">(</span><span class="n">all_samples</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
            <span class="c1"># TODO: https://github.com/UCL/causalprog/issues/87</span>
            <span class="n">value</span> <span class="o">+=</span> <span class="nb">sum</span><span class="p">(</span>
                <span class="n">l_mult</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">c</span><span class="p">(</span><span class="n">all_samples</span><span class="p">[</span><span class="n">component_to_index_mapping</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">constraints</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="k">return</span> <span class="n">value</span>

        <span class="k">return</span> <span class="n">_inner</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="causalprog.causal_problem.CausalProblem.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="o">*</span><span class="n">constraints</span><span class="p">,</span> <span class="n">causal_estimand</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Create a new causal problem.</p>


            <details class="quote">
              <summary>Source code in <code>src/causalprog/causal_problem/causal_problem.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">graph</span><span class="p">:</span> <span class="n">Graph</span><span class="p">,</span>
    <span class="o">*</span><span class="n">constraints</span><span class="p">:</span> <span class="n">Constraint</span><span class="p">,</span>
    <span class="n">causal_estimand</span><span class="p">:</span> <span class="n">CausalEstimand</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a new causal problem.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_underlying_graph</span> <span class="o">=</span> <span class="n">graph</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">causal_estimand</span> <span class="o">=</span> <span class="n">causal_estimand</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">constraints</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">constraints</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="causalprog.causal_problem.CausalProblem.lagrangian" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">lagrangian</span><span class="p">(</span><span class="n">n_samples</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">maximum_problem</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Return a function that evaluates the Lagrangian of this <code>CausalProblem</code>.</p>
<p>Following the
<a href="https://en.wikipedia.org/wiki/Karush%E2%80%93Kuhn%E2%80%93Tucker_conditions">KKT theorem</a>,
given the causal estimand and the constraints we can assemble a Lagrangian and
seek its stationary points, to in turn identify minimisers of the constrained
optimisation problem that we started with.</p>
<p>The Lagrangian returned is a mathematical function of its first two arguments.
The first argument is the same dictionary of parameters that is passed to models
like <code>Graph.model</code>, and is the values the parameters (represented by the
<code>ParameterNode</code>s) are taking. The second argument is a 1D vector of Lagrange
multipliers, whose length is equal to the number of constraints.</p>
<p>The remaining argument of the Lagrangian is the PRNG Key that should be used
when drawing samples.</p>
<p>Note that our current implementation assumes there are no equality constraints
being imposed (in which case, we would need a 3-argument Lagrangian function).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>n_samples</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of random samples to be drawn when estimating the
value of functions of the RVs.</p>
              </div>
            </td>
            <td>
                  <code>1000</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>maximum_problem</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If passed as <code>True</code>, assemble the Lagrangian for the
maximisation problem. Otherwise assemble that for the minimisation
problem (default behaviour).</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" title="collections.abc.Callable" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Callable">Callable</a>[[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <span title="numpy.typing.ArrayLike">ArrayLike</span>], <span title="numpy.typing.ArrayLike">ArrayLike</span>, <span title="jax.Array">Array</span>], <span title="numpy.typing.ArrayLike">ArrayLike</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The Lagrangian, as a function of the model parameters, Lagrange multipliers,
and PRNG key.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/causalprog/causal_problem/causal_problem.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">lagrangian</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">n_samples</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">maximum_problem</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">npt</span><span class="o">.</span><span class="n">ArrayLike</span><span class="p">],</span> <span class="n">npt</span><span class="o">.</span><span class="n">ArrayLike</span><span class="p">,</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">],</span> <span class="n">npt</span><span class="o">.</span><span class="n">ArrayLike</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return a function that evaluates the Lagrangian of this `CausalProblem`.</span>

<span class="sd">    Following the</span>
<span class="sd">    [KKT theorem](https://en.wikipedia.org/wiki/Karush%E2%80%93Kuhn%E2%80%93Tucker_conditions),</span>
<span class="sd">    given the causal estimand and the constraints we can assemble a Lagrangian and</span>
<span class="sd">    seek its stationary points, to in turn identify minimisers of the constrained</span>
<span class="sd">    optimisation problem that we started with.</span>

<span class="sd">    The Lagrangian returned is a mathematical function of its first two arguments.</span>
<span class="sd">    The first argument is the same dictionary of parameters that is passed to models</span>
<span class="sd">    like `Graph.model`, and is the values the parameters (represented by the</span>
<span class="sd">    `ParameterNode`s) are taking. The second argument is a 1D vector of Lagrange</span>
<span class="sd">    multipliers, whose length is equal to the number of constraints.</span>

<span class="sd">    The remaining argument of the Lagrangian is the PRNG Key that should be used</span>
<span class="sd">    when drawing samples.</span>

<span class="sd">    Note that our current implementation assumes there are no equality constraints</span>
<span class="sd">    being imposed (in which case, we would need a 3-argument Lagrangian function).</span>

<span class="sd">    Args:</span>
<span class="sd">        n_samples: The number of random samples to be drawn when estimating the</span>
<span class="sd">            value of functions of the RVs.</span>
<span class="sd">        maximum_problem: If passed as `True`, assemble the Lagrangian for the</span>
<span class="sd">            maximisation problem. Otherwise assemble that for the minimisation</span>
<span class="sd">            problem (default behaviour).</span>

<span class="sd">    Returns:</span>
<span class="sd">        The Lagrangian, as a function of the model parameters, Lagrange multipliers,</span>
<span class="sd">            and PRNG key.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">maximisation_prefactor</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span> <span class="k">if</span> <span class="n">maximum_problem</span> <span class="k">else</span> <span class="mf">1.0</span>

    <span class="c1"># Build association between self.constraints and the model-samples that each</span>
    <span class="c1"># one needs to use. We do this here, since once it is constructed, it is</span>
    <span class="c1"># fixed, and doesn&#39;t need to be done each time we call the Lagrangian.</span>
    <span class="n">models</span><span class="p">,</span> <span class="n">component_to_index_mapping</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_associate_models_to_components</span><span class="p">(</span>
        <span class="n">n_samples</span>
    <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_inner</span><span class="p">(</span>
        <span class="n">parameter_values</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">npt</span><span class="o">.</span><span class="n">ArrayLike</span><span class="p">],</span>
        <span class="n">l_mult</span><span class="p">:</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">,</span>
        <span class="n">rng_key</span><span class="p">:</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">npt</span><span class="o">.</span><span class="n">ArrayLike</span><span class="p">:</span>
        <span class="c1"># Draw samples from all models</span>
        <span class="n">all_samples</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span>
            <span class="n">sample_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">rng_key</span><span class="p">,</span> <span class="n">parameter_values</span><span class="p">)</span> <span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">models</span>
        <span class="p">)</span>

        <span class="n">value</span> <span class="o">=</span> <span class="n">maximisation_prefactor</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">causal_estimand</span><span class="p">(</span><span class="n">all_samples</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="c1"># TODO: https://github.com/UCL/causalprog/issues/87</span>
        <span class="n">value</span> <span class="o">+=</span> <span class="nb">sum</span><span class="p">(</span>
            <span class="n">l_mult</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">c</span><span class="p">(</span><span class="n">all_samples</span><span class="p">[</span><span class="n">component_to_index_mapping</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">constraints</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">value</span>

    <span class="k">return</span> <span class="n">_inner</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="causalprog.causal_problem.Constraint" class="doc doc-heading">
            <code>Constraint</code>


</h3>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="causalprog.causal_problem._base_component._CPComponent">_CPComponent</span></code></p>


        <p>A Constraint that forms part of a causal problem.</p>
<p>Constraints of a causal problem are derived properties of RVs for which we
have observed data. The causal estimand is minimised (or maximised) subject
to the predicted values of the constraints being close to their observed
values in the data.</p>
<p>Adding a constraint <span class="arithmatex">\(g(\theta)\)</span> to a causal problem (where <span class="arithmatex">\(\theta\)</span> are the
parameters of the causal problem) essentially imposes an additional
constraint on the minimisation problem;</p>
<div class="arithmatex">\[ g(\theta) - g_{\text{data}} \leq \epsilon, \]</div>
<p>where <span class="arithmatex">\(g_{\text{data}}\)</span> is the observed data value for the quantity <span class="arithmatex">\(g\)</span>,
and <span class="arithmatex">\(\epsilon\)</span> is some tolerance.</p>








              <details class="quote">
                <summary>Source code in <code>src/causalprog/causal_problem/components.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Constraint</span><span class="p">(</span><span class="n">_CPComponent</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A Constraint that forms part of a causal problem.</span>

<span class="sd">    Constraints of a causal problem are derived properties of RVs for which we</span>
<span class="sd">    have observed data. The causal estimand is minimised (or maximised) subject</span>
<span class="sd">    to the predicted values of the constraints being close to their observed</span>
<span class="sd">    values in the data.</span>

<span class="sd">    Adding a constraint $g(\theta)$ to a causal problem (where $\theta$ are the</span>
<span class="sd">    parameters of the causal problem) essentially imposes an additional</span>
<span class="sd">    constraint on the minimisation problem;</span>

<span class="sd">    $$ g(\theta) - g_{\text{data}} \leq \epsilon, $$</span>

<span class="sd">    where $g_{\text{data}}$ is the observed data value for the quantity $g$,</span>
<span class="sd">    and $\epsilon$ is some tolerance.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">data</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">ArrayLike</span>
    <span class="n">tolerance</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">ArrayLike</span>
    <span class="n">_outer_norm</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">npt</span><span class="o">.</span><span class="n">ArrayLike</span><span class="p">],</span> <span class="nb">float</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="o">*</span><span class="n">effect_handlers</span><span class="p">:</span> <span class="n">ModelMask</span><span class="p">,</span>
        <span class="n">model_quantity</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">npt</span><span class="o">.</span><span class="n">ArrayLike</span><span class="p">],</span>
        <span class="n">outer_norm</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">npt</span><span class="o">.</span><span class="n">ArrayLike</span><span class="p">],</span> <span class="nb">float</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">data</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">ArrayLike</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="n">tolerance</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0e-6</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a new constraint.</span>

<span class="sd">        Constraints have the form</span>

<span class="sd">        $$ c(\theta) :=</span>
<span class="sd">        \mathrm{norm}\left( g(\theta)</span>
<span class="sd">        - g_{\mathrm{data}} \right)</span>
<span class="sd">        - \epsilon $$</span>

<span class="sd">        where;</span>
<span class="sd">        - $\mathrm{norm}$ is the outer norm of the constraint (`outer_norm`),</span>
<span class="sd">        - $g(\theta)$ is the model quantity involved in the constraint</span>
<span class="sd">            (`model_quantity`),</span>
<span class="sd">        - $g_{\mathrm{data}}$ is the observed data (`data`),</span>
<span class="sd">        - $\epsilon$ is the tolerance in the data (`tolerance`).</span>

<span class="sd">        In a causal problem, each constraint appears as the condition $c(\theta)\leq 0$</span>
<span class="sd">        in the minimisation / maximisation (hence the inclusion of the $-\epsilon$</span>
<span class="sd">        term within $c(\theta)$ itself).</span>

<span class="sd">        $g$ should be a (possibly vector-valued) function that acts on (a subset of)</span>
<span class="sd">        samples from the random variables of the causal problem. It must accept</span>
<span class="sd">        variable keyword-arguments only, and should access the samples for each random</span>
<span class="sd">        variable by indexing via the RV names (node labels). It should return the</span>
<span class="sd">        model quantity as computed from the samples, that $g_{\mathrm{data}}$ observed.</span>

<span class="sd">        $g_{\mathrm{data}}$ should be a fixed value whose shape is broadcast-able with</span>
<span class="sd">        the return shape of $g$. It defaults to $0$ if not explicitly set.</span>

<span class="sd">        $\mathrm{norm}$ should be a suitable norm to take on the difference between the</span>
<span class="sd">        model quantity as predicted by the samples ($g$) and the observed data</span>
<span class="sd">        ($g_{\mathrm{data}}$). It must return a scalar value. The default is the 2-norm.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">effect_handlers</span><span class="p">,</span> <span class="n">do_with_samples</span><span class="o">=</span><span class="n">model_quantity</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">outer_norm</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_outer_norm</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">vector_norm</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_outer_norm</span> <span class="o">=</span> <span class="n">outer_norm</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tolerance</span> <span class="o">=</span> <span class="n">tolerance</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">samples</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">npt</span><span class="o">.</span><span class="n">ArrayLike</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">npt</span><span class="o">.</span><span class="n">ArrayLike</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Evaluate the constraint, given RV samples.</span>

<span class="sd">        Args:</span>
<span class="sd">            samples: Mapping of RV (node) labels to drawn samples.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Value of the constraint.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_outer_norm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_do_with_samples</span><span class="p">(</span><span class="o">**</span><span class="n">samples</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
            <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">tolerance</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="causalprog.causal_problem.Constraint.__call__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__call__</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Evaluate the constraint, given RV samples.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>samples</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <span title="numpy.typing.ArrayLike">ArrayLike</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Mapping of RV (node) labels to drawn samples.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.typing.ArrayLike">ArrayLike</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Value of the constraint.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/causalprog/causal_problem/components.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">samples</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">npt</span><span class="o">.</span><span class="n">ArrayLike</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">npt</span><span class="o">.</span><span class="n">ArrayLike</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Evaluate the constraint, given RV samples.</span>

<span class="sd">    Args:</span>
<span class="sd">        samples: Mapping of RV (node) labels to drawn samples.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Value of the constraint.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_outer_norm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_do_with_samples</span><span class="p">(</span><span class="o">**</span><span class="n">samples</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
        <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">tolerance</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="causalprog.causal_problem.Constraint.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">effect_handlers</span><span class="p">,</span> <span class="n">model_quantity</span><span class="p">,</span> <span class="n">outer_norm</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="mf">1e-06</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Create a new constraint.</p>
<p>Constraints have the form</p>
<div class="arithmatex">\[ c(\theta) :=
\mathrm{norm}\left( g(\theta)
- g_{\mathrm{data}} \right)
- \epsilon \]</div>
<p>where;
- <span class="arithmatex">\(\mathrm{norm}\)</span> is the outer norm of the constraint (<code>outer_norm</code>),
- <span class="arithmatex">\(g(\theta)\)</span> is the model quantity involved in the constraint
    (<code>model_quantity</code>),
- <span class="arithmatex">\(g_{\mathrm{data}}\)</span> is the observed data (<code>data</code>),
- <span class="arithmatex">\(\epsilon\)</span> is the tolerance in the data (<code>tolerance</code>).</p>
<p>In a causal problem, each constraint appears as the condition <span class="arithmatex">\(c(\theta)\leq 0\)</span>
in the minimisation / maximisation (hence the inclusion of the <span class="arithmatex">\(-\epsilon\)</span>
term within <span class="arithmatex">\(c(\theta)\)</span> itself).</p>
<p><span class="arithmatex">\(g\)</span> should be a (possibly vector-valued) function that acts on (a subset of)
samples from the random variables of the causal problem. It must accept
variable keyword-arguments only, and should access the samples for each random
variable by indexing via the RV names (node labels). It should return the
model quantity as computed from the samples, that <span class="arithmatex">\(g_{\mathrm{data}}\)</span> observed.</p>
<p><span class="arithmatex">\(g_{\mathrm{data}}\)</span> should be a fixed value whose shape is broadcast-able with
the return shape of <span class="arithmatex">\(g\)</span>. It defaults to <span class="arithmatex">\(0\)</span> if not explicitly set.</p>
<p><span class="arithmatex">\(\mathrm{norm}\)</span> should be a suitable norm to take on the difference between the
model quantity as predicted by the samples (<span class="arithmatex">\(g\)</span>) and the observed data
(<span class="arithmatex">\(g_{\mathrm{data}}\)</span>). It must return a scalar value. The default is the 2-norm.</p>


            <details class="quote">
              <summary>Source code in <code>src/causalprog/causal_problem/components.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span>
<span class="normal">97</span>
<span class="normal">98</span>
<span class="normal">99</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="o">*</span><span class="n">effect_handlers</span><span class="p">:</span> <span class="n">ModelMask</span><span class="p">,</span>
    <span class="n">model_quantity</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">npt</span><span class="o">.</span><span class="n">ArrayLike</span><span class="p">],</span>
    <span class="n">outer_norm</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">npt</span><span class="o">.</span><span class="n">ArrayLike</span><span class="p">],</span> <span class="nb">float</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">data</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">ArrayLike</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
    <span class="n">tolerance</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0e-6</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a new constraint.</span>

<span class="sd">    Constraints have the form</span>

<span class="sd">    $$ c(\theta) :=</span>
<span class="sd">    \mathrm{norm}\left( g(\theta)</span>
<span class="sd">    - g_{\mathrm{data}} \right)</span>
<span class="sd">    - \epsilon $$</span>

<span class="sd">    where;</span>
<span class="sd">    - $\mathrm{norm}$ is the outer norm of the constraint (`outer_norm`),</span>
<span class="sd">    - $g(\theta)$ is the model quantity involved in the constraint</span>
<span class="sd">        (`model_quantity`),</span>
<span class="sd">    - $g_{\mathrm{data}}$ is the observed data (`data`),</span>
<span class="sd">    - $\epsilon$ is the tolerance in the data (`tolerance`).</span>

<span class="sd">    In a causal problem, each constraint appears as the condition $c(\theta)\leq 0$</span>
<span class="sd">    in the minimisation / maximisation (hence the inclusion of the $-\epsilon$</span>
<span class="sd">    term within $c(\theta)$ itself).</span>

<span class="sd">    $g$ should be a (possibly vector-valued) function that acts on (a subset of)</span>
<span class="sd">    samples from the random variables of the causal problem. It must accept</span>
<span class="sd">    variable keyword-arguments only, and should access the samples for each random</span>
<span class="sd">    variable by indexing via the RV names (node labels). It should return the</span>
<span class="sd">    model quantity as computed from the samples, that $g_{\mathrm{data}}$ observed.</span>

<span class="sd">    $g_{\mathrm{data}}$ should be a fixed value whose shape is broadcast-able with</span>
<span class="sd">    the return shape of $g$. It defaults to $0$ if not explicitly set.</span>

<span class="sd">    $\mathrm{norm}$ should be a suitable norm to take on the difference between the</span>
<span class="sd">    model quantity as predicted by the samples ($g$) and the observed data</span>
<span class="sd">    ($g_{\mathrm{data}}$). It must return a scalar value. The default is the 2-norm.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">effect_handlers</span><span class="p">,</span> <span class="n">do_with_samples</span><span class="o">=</span><span class="n">model_quantity</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">outer_norm</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_outer_norm</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">vector_norm</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_outer_norm</span> <span class="o">=</span> <span class="n">outer_norm</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">tolerance</span> <span class="o">=</span> <span class="n">tolerance</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h3 id="causalprog.causal_problem.HandlerToApply" class="doc doc-heading">
            <code>HandlerToApply</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h3>


    <div class="doc doc-contents ">


        <p>Specifies a handler that needs to be applied to a model at runtime.</p>








              <details class="quote">
                <summary>Source code in <code>src/causalprog/causal_problem/handlers.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">HandlerToApply</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Specifies a handler that needs to be applied to a model at runtime.&quot;&quot;&quot;</span>

    <span class="n">handler</span><span class="p">:</span> <span class="n">EffectHandler</span>
    <span class="n">options</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">from_pair</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">pair</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;HandlerToApply&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create an instance from an effect handler and its options.</span>

<span class="sd">        The two objects should be passed in as the elements of a container of length</span>
<span class="sd">        2. They can be passed in any order;</span>
<span class="sd">        - One element must be a dictionary, which will be interpreted as the `options`</span>
<span class="sd">            for the effect handler.</span>
<span class="sd">        - The other element must be callable, and will be interpreted as the `handler`</span>
<span class="sd">            itself.</span>

<span class="sd">        Args:</span>
<span class="sd">            pair: Container of two elements, one being the effect handler callable and</span>
<span class="sd">                the other being the options to pass to it (as a dictionary).</span>

<span class="sd">        Returns:</span>
<span class="sd">            Class instance corresponding to the effect handler and options passed.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">pair</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>  <span class="c1"># noqa: PLR2004</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> can only be constructed from a container of 2 elements&quot;</span>
            <span class="p">)</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

        <span class="c1"># __post_init__ will catch cases when the incorrect types for one or both items</span>
        <span class="c1"># is passed, so we can just naively if-else here.</span>
        <span class="n">handler</span><span class="p">:</span> <span class="n">EffectHandler</span>
        <span class="n">options</span><span class="p">:</span> <span class="nb">dict</span>
        <span class="k">if</span> <span class="nb">callable</span><span class="p">(</span><span class="n">pair</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="n">handler</span> <span class="o">=</span> <span class="n">pair</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">options</span> <span class="o">=</span> <span class="n">pair</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">handler</span> <span class="o">=</span> <span class="n">pair</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">options</span> <span class="o">=</span> <span class="n">pair</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">handler</span><span class="o">=</span><span class="n">handler</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="n">options</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Validate set attributes.</span>

<span class="sd">        - The handler is a callable object.</span>
<span class="sd">        - The options have been passed as a dictionary of keyword-value pairs.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">callable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handler</span><span class="p">):</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handler</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not callable.&quot;</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span>
                <span class="s2">&quot;Options should be dictionary mapping option arguments to values &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;(got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">).&quot;</span>
            <span class="p">)</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Equality operation.</span>

<span class="sd">        `HandlerToApply`s are considered equal if they use the same handler function and</span>
<span class="sd">        provide the same options to this function.</span>

<span class="sd">        Comparison to other types returns `False`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">HandlerToApply</span><span class="p">)</span>
            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">handler</span> <span class="ow">is</span> <span class="n">other</span><span class="o">.</span><span class="n">handler</span>
            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">options</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="causalprog.causal_problem.HandlerToApply.__eq__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__eq__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Equality operation.</p>
<p><code>HandlerToApply</code>s are considered equal if they use the same handler function and
provide the same options to this function.</p>
<p>Comparison to other types returns <code>False</code>.</p>


            <details class="quote">
              <summary>Source code in <code>src/causalprog/causal_problem/handlers.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Equality operation.</span>

<span class="sd">    `HandlerToApply`s are considered equal if they use the same handler function and</span>
<span class="sd">    provide the same options to this function.</span>

<span class="sd">    Comparison to other types returns `False`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">HandlerToApply</span><span class="p">)</span>
        <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">handler</span> <span class="ow">is</span> <span class="n">other</span><span class="o">.</span><span class="n">handler</span>
        <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">options</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="causalprog.causal_problem.HandlerToApply.__post_init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">__post_init__</span><span class="p">()</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Validate set attributes.</p>
<ul>
<li>The handler is a callable object.</li>
<li>The options have been passed as a dictionary of keyword-value pairs.</li>
</ul>


            <details class="quote">
              <summary>Source code in <code>src/causalprog/causal_problem/handlers.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Validate set attributes.</span>

<span class="sd">    - The handler is a callable object.</span>
<span class="sd">    - The options have been passed as a dictionary of keyword-value pairs.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">callable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handler</span><span class="p">):</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handler</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not callable.&quot;</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;Options should be dictionary mapping option arguments to values &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;(got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">).&quot;</span>
        <span class="p">)</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h4 id="causalprog.causal_problem.HandlerToApply.from_pair" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">from_pair</span><span class="p">(</span><span class="n">pair</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">

        <p>Create an instance from an effect handler and its options.</p>
<p>The two objects should be passed in as the elements of a container of length
2. They can be passed in any order;
- One element must be a dictionary, which will be interpreted as the <code>options</code>
    for the effect handler.
- The other element must be callable, and will be interpreted as the <code>handler</code>
    itself.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>pair</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="collections.abc.Sequence" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence">Sequence</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Container of two elements, one being the effect handler callable and
the other being the options to pass to it (as a dictionary).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="HandlerToApply


  
      dataclass
   (causalprog.causal_problem.handlers.HandlerToApply)" href="#causalprog.causal_problem.handlers.HandlerToApply">HandlerToApply</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Class instance corresponding to the effect handler and options passed.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/causalprog/causal_problem/handlers.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">from_pair</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">pair</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;HandlerToApply&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create an instance from an effect handler and its options.</span>

<span class="sd">    The two objects should be passed in as the elements of a container of length</span>
<span class="sd">    2. They can be passed in any order;</span>
<span class="sd">    - One element must be a dictionary, which will be interpreted as the `options`</span>
<span class="sd">        for the effect handler.</span>
<span class="sd">    - The other element must be callable, and will be interpreted as the `handler`</span>
<span class="sd">        itself.</span>

<span class="sd">    Args:</span>
<span class="sd">        pair: Container of two elements, one being the effect handler callable and</span>
<span class="sd">            the other being the options to pass to it (as a dictionary).</span>

<span class="sd">    Returns:</span>
<span class="sd">        Class instance corresponding to the effect handler and options passed.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">pair</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>  <span class="c1"># noqa: PLR2004</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> can only be constructed from a container of 2 elements&quot;</span>
        <span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

    <span class="c1"># __post_init__ will catch cases when the incorrect types for one or both items</span>
    <span class="c1"># is passed, so we can just naively if-else here.</span>
    <span class="n">handler</span><span class="p">:</span> <span class="n">EffectHandler</span>
    <span class="n">options</span><span class="p">:</span> <span class="nb">dict</span>
    <span class="k">if</span> <span class="nb">callable</span><span class="p">(</span><span class="n">pair</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
        <span class="n">handler</span> <span class="o">=</span> <span class="n">pair</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">options</span> <span class="o">=</span> <span class="n">pair</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">handler</span> <span class="o">=</span> <span class="n">pair</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">options</span> <span class="o">=</span> <span class="n">pair</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">handler</span><span class="o">=</span><span class="n">handler</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="n">options</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>



<div class="doc doc-object doc-module">



<h3 id="causalprog.causal_problem.causal_problem" class="doc doc-heading">
            <code>causal_problem</code>


</h3>

    <div class="doc doc-contents ">

        <p>Classes for representing causal problems.</p>










  <div class="doc doc-children">









<div class="doc doc-object doc-class">



<h4 id="causalprog.causal_problem.causal_problem.CausalProblem" class="doc doc-heading">
            <code>CausalProblem</code>


</h4>


    <div class="doc doc-contents ">


        <p>Defines a causal problem.</p>








              <details class="quote">
                <summary>Source code in <code>src/causalprog/causal_problem/causal_problem.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">CausalProblem</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Defines a causal problem.&quot;&quot;&quot;</span>

    <span class="n">_underlying_graph</span><span class="p">:</span> <span class="n">Graph</span>
    <span class="n">causal_estimand</span><span class="p">:</span> <span class="n">CausalEstimand</span>
    <span class="n">constraints</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Constraint</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_ordered_components</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">[</span><span class="n">_CPComponent</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Internal ordering for components of the causal problem.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">[</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">constraints</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">causal_estimand</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">graph</span><span class="p">:</span> <span class="n">Graph</span><span class="p">,</span>
        <span class="o">*</span><span class="n">constraints</span><span class="p">:</span> <span class="n">Constraint</span><span class="p">,</span>
        <span class="n">causal_estimand</span><span class="p">:</span> <span class="n">CausalEstimand</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create a new causal problem.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_underlying_graph</span> <span class="o">=</span> <span class="n">graph</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">causal_estimand</span> <span class="o">=</span> <span class="n">causal_estimand</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">constraints</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">constraints</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_associate_models_to_components</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">n_samples</span><span class="p">:</span> <span class="nb">int</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="n">Predictive</span><span class="p">],</span> <span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create models to be used by components of the problem.</span>

<span class="sd">        Depending on how many constraints (and the causal estimand) require effect</span>
<span class="sd">        handlers to wrap `self._underlying_graph.model`, we will need to create several</span>
<span class="sd">        predictive models to sample from. However, we also want to minimise the number</span>
<span class="sd">        of such models we have to make, in order to minimise the time we spend</span>
<span class="sd">        actually computing samples.</span>

<span class="sd">        As such, in this method we determine:</span>
<span class="sd">        - How many models we will need to build, by grouping the constraints and the</span>
<span class="sd">          causal estimand by the handlers they use.</span>
<span class="sd">        - Build these models, returning them in a list called `models`.</span>
<span class="sd">        - Build another list that maps the index of components in</span>
<span class="sd">          `self._ordered_components` to the index of the model in `models` that they</span>
<span class="sd">          use. The causal estimand is by convention the component at index -1 of this</span>
<span class="sd">          returned list.</span>

<span class="sd">        Args:</span>
<span class="sd">            n_samples: Value to be passed to `numpyro.Predictive`&#39;s `num_samples`</span>
<span class="sd">                argument for each of the models that are constructed from the underlying</span>
<span class="sd">                graph.</span>

<span class="sd">        Returns:</span>
<span class="sd">            list[Predictive]: List of Predictive models, whose elements contain all the</span>
<span class="sd">                models needed by the components.</span>
<span class="sd">            list[int]: Mapping of component indexes (as per `self_ordered_components`)</span>
<span class="sd">                to the index of the model in the first return argument that the</span>
<span class="sd">                component uses.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">models</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="n">Predictive</span><span class="p">]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">grouped_component_indexes</span><span class="p">:</span> <span class="nb">list</span><span class="p">[</span><span class="nb">list</span><span class="p">[</span><span class="nb">int</span><span class="p">]]</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">component</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ordered_components</span><span class="p">):</span>
            <span class="c1"># Determine if this constraint uses the same handlers as those of any of</span>
            <span class="c1"># the other sets.</span>
            <span class="n">belongs_to_existing_group</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">grouped_component_indexes</span><span class="p">:</span>
                <span class="c1"># Pull any element from the group to compare models to.</span>
                <span class="c1"># Items in a group are known to have the same model, so we can just</span>
                <span class="c1"># pull out the first one.</span>
                <span class="n">group_element</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_ordered_components</span><span class="p">[</span><span class="n">group</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
                <span class="c1"># Check if the current constraint can also use this model.</span>
                <span class="k">if</span> <span class="n">component</span><span class="o">.</span><span class="n">can_use_same_model_as</span><span class="p">(</span><span class="n">group_element</span><span class="p">):</span>
                    <span class="n">group</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
                    <span class="n">belongs_to_existing_group</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="k">break</span>

            <span class="c1"># If the component does not fit into any existing group, create a new</span>
            <span class="c1"># group for it. And add the model corresponding to the group to the</span>
            <span class="c1"># list of models.</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">belongs_to_existing_group</span><span class="p">:</span>
                <span class="n">grouped_component_indexes</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">index</span><span class="p">])</span>

                <span class="n">models</span><span class="o">.</span><span class="n">append</span><span class="p">(</span>
                    <span class="n">Predictive</span><span class="p">(</span>
                        <span class="n">component</span><span class="o">.</span><span class="n">apply_effects</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_underlying_graph</span><span class="o">.</span><span class="n">model</span><span class="p">),</span>
                        <span class="n">num_samples</span><span class="o">=</span><span class="n">n_samples</span><span class="p">,</span>
                    <span class="p">)</span>
                <span class="p">)</span>

        <span class="c1"># Now &quot;invert&quot; the grouping, creating a mapping that maps the index of a</span>
        <span class="c1"># component to the (index of the) model it uses.</span>
        <span class="n">component_index_to_model_index</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">index</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_ordered_components</span><span class="p">)):</span>
            <span class="k">for</span> <span class="n">group_index</span><span class="p">,</span> <span class="n">group</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">grouped_component_indexes</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">index</span> <span class="ow">in</span> <span class="n">group</span><span class="p">:</span>
                    <span class="n">component_index_to_model_index</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">group_index</span><span class="p">)</span>
                    <span class="k">break</span>
        <span class="c1"># All indexes should belong to at least one group (worst case scenario,</span>
        <span class="c1"># their own individual group). Thus, it is safe to do the above to create</span>
        <span class="c1"># the mapping from component index -&gt; model (group) index.</span>
        <span class="k">return</span> <span class="n">models</span><span class="p">,</span> <span class="n">component_index_to_model_index</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">lagrangian</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">n_samples</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">maximum_problem</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">npt</span><span class="o">.</span><span class="n">ArrayLike</span><span class="p">],</span> <span class="n">npt</span><span class="o">.</span><span class="n">ArrayLike</span><span class="p">,</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">],</span> <span class="n">npt</span><span class="o">.</span><span class="n">ArrayLike</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return a function that evaluates the Lagrangian of this `CausalProblem`.</span>

<span class="sd">        Following the</span>
<span class="sd">        [KKT theorem](https://en.wikipedia.org/wiki/Karush%E2%80%93Kuhn%E2%80%93Tucker_conditions),</span>
<span class="sd">        given the causal estimand and the constraints we can assemble a Lagrangian and</span>
<span class="sd">        seek its stationary points, to in turn identify minimisers of the constrained</span>
<span class="sd">        optimisation problem that we started with.</span>

<span class="sd">        The Lagrangian returned is a mathematical function of its first two arguments.</span>
<span class="sd">        The first argument is the same dictionary of parameters that is passed to models</span>
<span class="sd">        like `Graph.model`, and is the values the parameters (represented by the</span>
<span class="sd">        `ParameterNode`s) are taking. The second argument is a 1D vector of Lagrange</span>
<span class="sd">        multipliers, whose length is equal to the number of constraints.</span>

<span class="sd">        The remaining argument of the Lagrangian is the PRNG Key that should be used</span>
<span class="sd">        when drawing samples.</span>

<span class="sd">        Note that our current implementation assumes there are no equality constraints</span>
<span class="sd">        being imposed (in which case, we would need a 3-argument Lagrangian function).</span>

<span class="sd">        Args:</span>
<span class="sd">            n_samples: The number of random samples to be drawn when estimating the</span>
<span class="sd">                value of functions of the RVs.</span>
<span class="sd">            maximum_problem: If passed as `True`, assemble the Lagrangian for the</span>
<span class="sd">                maximisation problem. Otherwise assemble that for the minimisation</span>
<span class="sd">                problem (default behaviour).</span>

<span class="sd">        Returns:</span>
<span class="sd">            The Lagrangian, as a function of the model parameters, Lagrange multipliers,</span>
<span class="sd">                and PRNG key.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">maximisation_prefactor</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span> <span class="k">if</span> <span class="n">maximum_problem</span> <span class="k">else</span> <span class="mf">1.0</span>

        <span class="c1"># Build association between self.constraints and the model-samples that each</span>
        <span class="c1"># one needs to use. We do this here, since once it is constructed, it is</span>
        <span class="c1"># fixed, and doesn&#39;t need to be done each time we call the Lagrangian.</span>
        <span class="n">models</span><span class="p">,</span> <span class="n">component_to_index_mapping</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_associate_models_to_components</span><span class="p">(</span>
            <span class="n">n_samples</span>
        <span class="p">)</span>

        <span class="k">def</span><span class="w"> </span><span class="nf">_inner</span><span class="p">(</span>
            <span class="n">parameter_values</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">npt</span><span class="o">.</span><span class="n">ArrayLike</span><span class="p">],</span>
            <span class="n">l_mult</span><span class="p">:</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">,</span>
            <span class="n">rng_key</span><span class="p">:</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">,</span>
        <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">npt</span><span class="o">.</span><span class="n">ArrayLike</span><span class="p">:</span>
            <span class="c1"># Draw samples from all models</span>
            <span class="n">all_samples</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span>
                <span class="n">sample_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">rng_key</span><span class="p">,</span> <span class="n">parameter_values</span><span class="p">)</span> <span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">models</span>
            <span class="p">)</span>

            <span class="n">value</span> <span class="o">=</span> <span class="n">maximisation_prefactor</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">causal_estimand</span><span class="p">(</span><span class="n">all_samples</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
            <span class="c1"># TODO: https://github.com/UCL/causalprog/issues/87</span>
            <span class="n">value</span> <span class="o">+=</span> <span class="nb">sum</span><span class="p">(</span>
                <span class="n">l_mult</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">c</span><span class="p">(</span><span class="n">all_samples</span><span class="p">[</span><span class="n">component_to_index_mapping</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">constraints</span><span class="p">)</span>
            <span class="p">)</span>
            <span class="k">return</span> <span class="n">value</span>

        <span class="k">return</span> <span class="n">_inner</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h5 id="causalprog.causal_problem.causal_problem.CausalProblem.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">graph</span><span class="p">,</span> <span class="o">*</span><span class="n">constraints</span><span class="p">,</span> <span class="n">causal_estimand</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Create a new causal problem.</p>


            <details class="quote">
              <summary>Source code in <code>src/causalprog/causal_problem/causal_problem.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">graph</span><span class="p">:</span> <span class="n">Graph</span><span class="p">,</span>
    <span class="o">*</span><span class="n">constraints</span><span class="p">:</span> <span class="n">Constraint</span><span class="p">,</span>
    <span class="n">causal_estimand</span><span class="p">:</span> <span class="n">CausalEstimand</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Create a new causal problem.&quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_underlying_graph</span> <span class="o">=</span> <span class="n">graph</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">causal_estimand</span> <span class="o">=</span> <span class="n">causal_estimand</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">constraints</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">constraints</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="causalprog.causal_problem.causal_problem.CausalProblem.lagrangian" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">lagrangian</span><span class="p">(</span><span class="n">n_samples</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">maximum_problem</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Return a function that evaluates the Lagrangian of this <code>CausalProblem</code>.</p>
<p>Following the
<a href="https://en.wikipedia.org/wiki/Karush%E2%80%93Kuhn%E2%80%93Tucker_conditions">KKT theorem</a>,
given the causal estimand and the constraints we can assemble a Lagrangian and
seek its stationary points, to in turn identify minimisers of the constrained
optimisation problem that we started with.</p>
<p>The Lagrangian returned is a mathematical function of its first two arguments.
The first argument is the same dictionary of parameters that is passed to models
like <code>Graph.model</code>, and is the values the parameters (represented by the
<code>ParameterNode</code>s) are taking. The second argument is a 1D vector of Lagrange
multipliers, whose length is equal to the number of constraints.</p>
<p>The remaining argument of the Lagrangian is the PRNG Key that should be used
when drawing samples.</p>
<p>Note that our current implementation assumes there are no equality constraints
being imposed (in which case, we would need a 3-argument Lagrangian function).</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>n_samples</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The number of random samples to be drawn when estimating the
value of functions of the RVs.</p>
              </div>
            </td>
            <td>
                  <code>1000</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>maximum_problem</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>If passed as <code>True</code>, assemble the Lagrangian for the
maximisation problem. Otherwise assemble that for the minimisation
problem (default behaviour).</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" title="collections.abc.Callable" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Callable">Callable</a>[[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <span title="numpy.typing.ArrayLike">ArrayLike</span>], <span title="numpy.typing.ArrayLike">ArrayLike</span>, <span title="jax.Array">Array</span>], <span title="numpy.typing.ArrayLike">ArrayLike</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The Lagrangian, as a function of the model parameters, Lagrange multipliers,
and PRNG key.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/causalprog/causal_problem/causal_problem.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">lagrangian</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">n_samples</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">maximum_problem</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Callable</span><span class="p">[[</span><span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">npt</span><span class="o">.</span><span class="n">ArrayLike</span><span class="p">],</span> <span class="n">npt</span><span class="o">.</span><span class="n">ArrayLike</span><span class="p">,</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">],</span> <span class="n">npt</span><span class="o">.</span><span class="n">ArrayLike</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Return a function that evaluates the Lagrangian of this `CausalProblem`.</span>

<span class="sd">    Following the</span>
<span class="sd">    [KKT theorem](https://en.wikipedia.org/wiki/Karush%E2%80%93Kuhn%E2%80%93Tucker_conditions),</span>
<span class="sd">    given the causal estimand and the constraints we can assemble a Lagrangian and</span>
<span class="sd">    seek its stationary points, to in turn identify minimisers of the constrained</span>
<span class="sd">    optimisation problem that we started with.</span>

<span class="sd">    The Lagrangian returned is a mathematical function of its first two arguments.</span>
<span class="sd">    The first argument is the same dictionary of parameters that is passed to models</span>
<span class="sd">    like `Graph.model`, and is the values the parameters (represented by the</span>
<span class="sd">    `ParameterNode`s) are taking. The second argument is a 1D vector of Lagrange</span>
<span class="sd">    multipliers, whose length is equal to the number of constraints.</span>

<span class="sd">    The remaining argument of the Lagrangian is the PRNG Key that should be used</span>
<span class="sd">    when drawing samples.</span>

<span class="sd">    Note that our current implementation assumes there are no equality constraints</span>
<span class="sd">    being imposed (in which case, we would need a 3-argument Lagrangian function).</span>

<span class="sd">    Args:</span>
<span class="sd">        n_samples: The number of random samples to be drawn when estimating the</span>
<span class="sd">            value of functions of the RVs.</span>
<span class="sd">        maximum_problem: If passed as `True`, assemble the Lagrangian for the</span>
<span class="sd">            maximisation problem. Otherwise assemble that for the minimisation</span>
<span class="sd">            problem (default behaviour).</span>

<span class="sd">    Returns:</span>
<span class="sd">        The Lagrangian, as a function of the model parameters, Lagrange multipliers,</span>
<span class="sd">            and PRNG key.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">maximisation_prefactor</span> <span class="o">=</span> <span class="o">-</span><span class="mf">1.0</span> <span class="k">if</span> <span class="n">maximum_problem</span> <span class="k">else</span> <span class="mf">1.0</span>

    <span class="c1"># Build association between self.constraints and the model-samples that each</span>
    <span class="c1"># one needs to use. We do this here, since once it is constructed, it is</span>
    <span class="c1"># fixed, and doesn&#39;t need to be done each time we call the Lagrangian.</span>
    <span class="n">models</span><span class="p">,</span> <span class="n">component_to_index_mapping</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_associate_models_to_components</span><span class="p">(</span>
        <span class="n">n_samples</span>
    <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">_inner</span><span class="p">(</span>
        <span class="n">parameter_values</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">npt</span><span class="o">.</span><span class="n">ArrayLike</span><span class="p">],</span>
        <span class="n">l_mult</span><span class="p">:</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">,</span>
        <span class="n">rng_key</span><span class="p">:</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">npt</span><span class="o">.</span><span class="n">ArrayLike</span><span class="p">:</span>
        <span class="c1"># Draw samples from all models</span>
        <span class="n">all_samples</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span>
            <span class="n">sample_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">rng_key</span><span class="p">,</span> <span class="n">parameter_values</span><span class="p">)</span> <span class="k">for</span> <span class="n">model</span> <span class="ow">in</span> <span class="n">models</span>
        <span class="p">)</span>

        <span class="n">value</span> <span class="o">=</span> <span class="n">maximisation_prefactor</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">causal_estimand</span><span class="p">(</span><span class="n">all_samples</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="c1"># TODO: https://github.com/UCL/causalprog/issues/87</span>
        <span class="n">value</span> <span class="o">+=</span> <span class="nb">sum</span><span class="p">(</span>
            <span class="n">l_mult</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">c</span><span class="p">(</span><span class="n">all_samples</span><span class="p">[</span><span class="n">component_to_index_mapping</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">c</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">constraints</span><span class="p">)</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">value</span>

    <span class="k">return</span> <span class="n">_inner</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>


<div class="doc doc-object doc-function">


<h4 id="causalprog.causal_problem.causal_problem.sample_model" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">sample_model</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">rng_key</span><span class="p">,</span> <span class="n">parameter_values</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Draw samples from the predictive model.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>model</code>
            </td>
            <td>
                  <code><span title="numpyro.infer.Predictive">Predictive</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Predictive model to draw samples from.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rng_key</code>
            </td>
            <td>
                  <code><span title="jax.Array">Array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>PRNG Key to use in pseudorandom number generation.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>parameter_values</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <span title="numpy.typing.ArrayLike">ArrayLike</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Model parameter values to substitute.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <span title="numpy.typing.ArrayLike">ArrayLike</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><code>dict</code> of samples, with RV labels as keys and sample values (<code>jax.Array</code>s) as
values.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/causalprog/causal_problem/causal_problem.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">sample_model</span><span class="p">(</span>
    <span class="n">model</span><span class="p">:</span> <span class="n">Predictive</span><span class="p">,</span> <span class="n">rng_key</span><span class="p">:</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">,</span> <span class="n">parameter_values</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">npt</span><span class="o">.</span><span class="n">ArrayLike</span><span class="p">]</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">npt</span><span class="o">.</span><span class="n">ArrayLike</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Draw samples from the predictive model.</span>

<span class="sd">    Args:</span>
<span class="sd">        model: Predictive model to draw samples from.</span>
<span class="sd">        rng_key: PRNG Key to use in pseudorandom number generation.</span>
<span class="sd">        parameter_values: Model parameter values to substitute.</span>

<span class="sd">    Returns:</span>
<span class="sd">        `dict` of samples, with RV labels as keys and sample values (`jax.Array`s) as</span>
<span class="sd">            values.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">jax</span><span class="o">.</span><span class="n">vmap</span><span class="p">(</span><span class="k">lambda</span> <span class="n">pv</span><span class="p">,</span> <span class="n">key</span><span class="p">:</span> <span class="n">model</span><span class="p">(</span><span class="n">key</span><span class="p">,</span> <span class="o">**</span><span class="n">pv</span><span class="p">),</span> <span class="n">in_axes</span><span class="o">=</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="mi">0</span><span class="p">))(</span>
        <span class="n">parameter_values</span><span class="p">,</span>
        <span class="n">jax</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">rng_key</span><span class="p">,</span> <span class="n">model</span><span class="o">.</span><span class="n">num_samples</span><span class="p">),</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="causalprog.causal_problem.components" class="doc doc-heading">
            <code>components</code>


</h3>

    <div class="doc doc-contents ">

        <p>Classes for defining causal estimands and constraints of causal problems.</p>










  <div class="doc doc-children">









<div class="doc doc-object doc-class">



<h4 id="causalprog.causal_problem.components.CausalEstimand" class="doc doc-heading">
            <code>CausalEstimand</code>


</h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="causalprog.causal_problem._base_component._CPComponent">_CPComponent</span></code></p>


        <p>A Causal Estimand.</p>
<p>The causal estimand is the function that we want to minimise (and maximise)
as part of a causal problem. It should be a scalar-valued function of the
random variables appearing in a graph.</p>








              <details class="quote">
                <summary>Source code in <code>src/causalprog/causal_problem/components.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">CausalEstimand</span><span class="p">(</span><span class="n">_CPComponent</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A Causal Estimand.</span>

<span class="sd">    The causal estimand is the function that we want to minimise (and maximise)</span>
<span class="sd">    as part of a causal problem. It should be a scalar-valued function of the</span>
<span class="sd">    random variables appearing in a graph.</span>
<span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">












  </div>

    </div>

</div>

<div class="doc doc-object doc-class">



<h4 id="causalprog.causal_problem.components.Constraint" class="doc doc-heading">
            <code>Constraint</code>


</h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="causalprog.causal_problem._base_component._CPComponent">_CPComponent</span></code></p>


        <p>A Constraint that forms part of a causal problem.</p>
<p>Constraints of a causal problem are derived properties of RVs for which we
have observed data. The causal estimand is minimised (or maximised) subject
to the predicted values of the constraints being close to their observed
values in the data.</p>
<p>Adding a constraint <span class="arithmatex">\(g(\theta)\)</span> to a causal problem (where <span class="arithmatex">\(\theta\)</span> are the
parameters of the causal problem) essentially imposes an additional
constraint on the minimisation problem;</p>
<div class="arithmatex">\[ g(\theta) - g_{\text{data}} \leq \epsilon, \]</div>
<p>where <span class="arithmatex">\(g_{\text{data}}\)</span> is the observed data value for the quantity <span class="arithmatex">\(g\)</span>,
and <span class="arithmatex">\(\epsilon\)</span> is some tolerance.</p>








              <details class="quote">
                <summary>Source code in <code>src/causalprog/causal_problem/components.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Constraint</span><span class="p">(</span><span class="n">_CPComponent</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A Constraint that forms part of a causal problem.</span>

<span class="sd">    Constraints of a causal problem are derived properties of RVs for which we</span>
<span class="sd">    have observed data. The causal estimand is minimised (or maximised) subject</span>
<span class="sd">    to the predicted values of the constraints being close to their observed</span>
<span class="sd">    values in the data.</span>

<span class="sd">    Adding a constraint $g(\theta)$ to a causal problem (where $\theta$ are the</span>
<span class="sd">    parameters of the causal problem) essentially imposes an additional</span>
<span class="sd">    constraint on the minimisation problem;</span>

<span class="sd">    $$ g(\theta) - g_{\text{data}} \leq \epsilon, $$</span>

<span class="sd">    where $g_{\text{data}}$ is the observed data value for the quantity $g$,</span>
<span class="sd">    and $\epsilon$ is some tolerance.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">data</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">ArrayLike</span>
    <span class="n">tolerance</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">ArrayLike</span>
    <span class="n">_outer_norm</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">npt</span><span class="o">.</span><span class="n">ArrayLike</span><span class="p">],</span> <span class="nb">float</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="o">*</span><span class="n">effect_handlers</span><span class="p">:</span> <span class="n">ModelMask</span><span class="p">,</span>
        <span class="n">model_quantity</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">npt</span><span class="o">.</span><span class="n">ArrayLike</span><span class="p">],</span>
        <span class="n">outer_norm</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">npt</span><span class="o">.</span><span class="n">ArrayLike</span><span class="p">],</span> <span class="nb">float</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">data</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">ArrayLike</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
        <span class="n">tolerance</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0e-6</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a new constraint.</span>

<span class="sd">        Constraints have the form</span>

<span class="sd">        $$ c(\theta) :=</span>
<span class="sd">        \mathrm{norm}\left( g(\theta)</span>
<span class="sd">        - g_{\mathrm{data}} \right)</span>
<span class="sd">        - \epsilon $$</span>

<span class="sd">        where;</span>
<span class="sd">        - $\mathrm{norm}$ is the outer norm of the constraint (`outer_norm`),</span>
<span class="sd">        - $g(\theta)$ is the model quantity involved in the constraint</span>
<span class="sd">            (`model_quantity`),</span>
<span class="sd">        - $g_{\mathrm{data}}$ is the observed data (`data`),</span>
<span class="sd">        - $\epsilon$ is the tolerance in the data (`tolerance`).</span>

<span class="sd">        In a causal problem, each constraint appears as the condition $c(\theta)\leq 0$</span>
<span class="sd">        in the minimisation / maximisation (hence the inclusion of the $-\epsilon$</span>
<span class="sd">        term within $c(\theta)$ itself).</span>

<span class="sd">        $g$ should be a (possibly vector-valued) function that acts on (a subset of)</span>
<span class="sd">        samples from the random variables of the causal problem. It must accept</span>
<span class="sd">        variable keyword-arguments only, and should access the samples for each random</span>
<span class="sd">        variable by indexing via the RV names (node labels). It should return the</span>
<span class="sd">        model quantity as computed from the samples, that $g_{\mathrm{data}}$ observed.</span>

<span class="sd">        $g_{\mathrm{data}}$ should be a fixed value whose shape is broadcast-able with</span>
<span class="sd">        the return shape of $g$. It defaults to $0$ if not explicitly set.</span>

<span class="sd">        $\mathrm{norm}$ should be a suitable norm to take on the difference between the</span>
<span class="sd">        model quantity as predicted by the samples ($g$) and the observed data</span>
<span class="sd">        ($g_{\mathrm{data}}$). It must return a scalar value. The default is the 2-norm.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">effect_handlers</span><span class="p">,</span> <span class="n">do_with_samples</span><span class="o">=</span><span class="n">model_quantity</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">outer_norm</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_outer_norm</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">vector_norm</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_outer_norm</span> <span class="o">=</span> <span class="n">outer_norm</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tolerance</span> <span class="o">=</span> <span class="n">tolerance</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">samples</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">npt</span><span class="o">.</span><span class="n">ArrayLike</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">npt</span><span class="o">.</span><span class="n">ArrayLike</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Evaluate the constraint, given RV samples.</span>

<span class="sd">        Args:</span>
<span class="sd">            samples: Mapping of RV (node) labels to drawn samples.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Value of the constraint.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_outer_norm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_do_with_samples</span><span class="p">(</span><span class="o">**</span><span class="n">samples</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
            <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">tolerance</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h5 id="causalprog.causal_problem.components.Constraint.__call__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__call__</span><span class="p">(</span><span class="n">samples</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Evaluate the constraint, given RV samples.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>samples</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <span title="numpy.typing.ArrayLike">ArrayLike</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Mapping of RV (node) labels to drawn samples.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><span title="numpy.typing.ArrayLike">ArrayLike</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Value of the constraint.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/causalprog/causal_problem/components.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">samples</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">npt</span><span class="o">.</span><span class="n">ArrayLike</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">npt</span><span class="o">.</span><span class="n">ArrayLike</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Evaluate the constraint, given RV samples.</span>

<span class="sd">    Args:</span>
<span class="sd">        samples: Mapping of RV (node) labels to drawn samples.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Value of the constraint.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_outer_norm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_do_with_samples</span><span class="p">(</span><span class="o">**</span><span class="n">samples</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">data</span><span class="p">)</span>
        <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">tolerance</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="causalprog.causal_problem.components.Constraint.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">effect_handlers</span><span class="p">,</span> <span class="n">model_quantity</span><span class="p">,</span> <span class="n">outer_norm</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="mf">1e-06</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Create a new constraint.</p>
<p>Constraints have the form</p>
<div class="arithmatex">\[ c(\theta) :=
\mathrm{norm}\left( g(\theta)
- g_{\mathrm{data}} \right)
- \epsilon \]</div>
<p>where;
- <span class="arithmatex">\(\mathrm{norm}\)</span> is the outer norm of the constraint (<code>outer_norm</code>),
- <span class="arithmatex">\(g(\theta)\)</span> is the model quantity involved in the constraint
    (<code>model_quantity</code>),
- <span class="arithmatex">\(g_{\mathrm{data}}\)</span> is the observed data (<code>data</code>),
- <span class="arithmatex">\(\epsilon\)</span> is the tolerance in the data (<code>tolerance</code>).</p>
<p>In a causal problem, each constraint appears as the condition <span class="arithmatex">\(c(\theta)\leq 0\)</span>
in the minimisation / maximisation (hence the inclusion of the <span class="arithmatex">\(-\epsilon\)</span>
term within <span class="arithmatex">\(c(\theta)\)</span> itself).</p>
<p><span class="arithmatex">\(g\)</span> should be a (possibly vector-valued) function that acts on (a subset of)
samples from the random variables of the causal problem. It must accept
variable keyword-arguments only, and should access the samples for each random
variable by indexing via the RV names (node labels). It should return the
model quantity as computed from the samples, that <span class="arithmatex">\(g_{\mathrm{data}}\)</span> observed.</p>
<p><span class="arithmatex">\(g_{\mathrm{data}}\)</span> should be a fixed value whose shape is broadcast-able with
the return shape of <span class="arithmatex">\(g\)</span>. It defaults to <span class="arithmatex">\(0\)</span> if not explicitly set.</p>
<p><span class="arithmatex">\(\mathrm{norm}\)</span> should be a suitable norm to take on the difference between the
model quantity as predicted by the samples (<span class="arithmatex">\(g\)</span>) and the observed data
(<span class="arithmatex">\(g_{\mathrm{data}}\)</span>). It must return a scalar value. The default is the 2-norm.</p>


            <details class="quote">
              <summary>Source code in <code>src/causalprog/causal_problem/components.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span>
<span class="normal">97</span>
<span class="normal">98</span>
<span class="normal">99</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="o">*</span><span class="n">effect_handlers</span><span class="p">:</span> <span class="n">ModelMask</span><span class="p">,</span>
    <span class="n">model_quantity</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">npt</span><span class="o">.</span><span class="n">ArrayLike</span><span class="p">],</span>
    <span class="n">outer_norm</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">npt</span><span class="o">.</span><span class="n">ArrayLike</span><span class="p">],</span> <span class="nb">float</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">data</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">ArrayLike</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span>
    <span class="n">tolerance</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0e-6</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a new constraint.</span>

<span class="sd">    Constraints have the form</span>

<span class="sd">    $$ c(\theta) :=</span>
<span class="sd">    \mathrm{norm}\left( g(\theta)</span>
<span class="sd">    - g_{\mathrm{data}} \right)</span>
<span class="sd">    - \epsilon $$</span>

<span class="sd">    where;</span>
<span class="sd">    - $\mathrm{norm}$ is the outer norm of the constraint (`outer_norm`),</span>
<span class="sd">    - $g(\theta)$ is the model quantity involved in the constraint</span>
<span class="sd">        (`model_quantity`),</span>
<span class="sd">    - $g_{\mathrm{data}}$ is the observed data (`data`),</span>
<span class="sd">    - $\epsilon$ is the tolerance in the data (`tolerance`).</span>

<span class="sd">    In a causal problem, each constraint appears as the condition $c(\theta)\leq 0$</span>
<span class="sd">    in the minimisation / maximisation (hence the inclusion of the $-\epsilon$</span>
<span class="sd">    term within $c(\theta)$ itself).</span>

<span class="sd">    $g$ should be a (possibly vector-valued) function that acts on (a subset of)</span>
<span class="sd">    samples from the random variables of the causal problem. It must accept</span>
<span class="sd">    variable keyword-arguments only, and should access the samples for each random</span>
<span class="sd">    variable by indexing via the RV names (node labels). It should return the</span>
<span class="sd">    model quantity as computed from the samples, that $g_{\mathrm{data}}$ observed.</span>

<span class="sd">    $g_{\mathrm{data}}$ should be a fixed value whose shape is broadcast-able with</span>
<span class="sd">    the return shape of $g$. It defaults to $0$ if not explicitly set.</span>

<span class="sd">    $\mathrm{norm}$ should be a suitable norm to take on the difference between the</span>
<span class="sd">    model quantity as predicted by the samples ($g$) and the observed data</span>
<span class="sd">    ($g_{\mathrm{data}}$). It must return a scalar value. The default is the 2-norm.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">effect_handlers</span><span class="p">,</span> <span class="n">do_with_samples</span><span class="o">=</span><span class="n">model_quantity</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">outer_norm</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_outer_norm</span> <span class="o">=</span> <span class="n">jnp</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">vector_norm</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_outer_norm</span> <span class="o">=</span> <span class="n">outer_norm</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">tolerance</span> <span class="o">=</span> <span class="n">tolerance</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="causalprog.causal_problem.handlers" class="doc doc-heading">
            <code>handlers</code>


</h3>

    <div class="doc doc-contents ">

        <p>Container class for specifying effect handlers that need to be applied at runtime.</p>










  <div class="doc doc-children">









<div class="doc doc-object doc-class">



<h4 id="causalprog.causal_problem.handlers.HandlerToApply" class="doc doc-heading">
            <code>HandlerToApply</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">


        <p>Specifies a handler that needs to be applied to a model at runtime.</p>








              <details class="quote">
                <summary>Source code in <code>src/causalprog/causal_problem/handlers.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span>
<span class="k">class</span><span class="w"> </span><span class="nc">HandlerToApply</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Specifies a handler that needs to be applied to a model at runtime.&quot;&quot;&quot;</span>

    <span class="n">handler</span><span class="p">:</span> <span class="n">EffectHandler</span>
    <span class="n">options</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]</span> <span class="o">=</span> <span class="n">field</span><span class="p">(</span><span class="n">default_factory</span><span class="o">=</span><span class="nb">dict</span><span class="p">)</span>

    <span class="nd">@classmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">from_pair</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">pair</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;HandlerToApply&quot;</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create an instance from an effect handler and its options.</span>

<span class="sd">        The two objects should be passed in as the elements of a container of length</span>
<span class="sd">        2. They can be passed in any order;</span>
<span class="sd">        - One element must be a dictionary, which will be interpreted as the `options`</span>
<span class="sd">            for the effect handler.</span>
<span class="sd">        - The other element must be callable, and will be interpreted as the `handler`</span>
<span class="sd">            itself.</span>

<span class="sd">        Args:</span>
<span class="sd">            pair: Container of two elements, one being the effect handler callable and</span>
<span class="sd">                the other being the options to pass to it (as a dictionary).</span>

<span class="sd">        Returns:</span>
<span class="sd">            Class instance corresponding to the effect handler and options passed.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">pair</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>  <span class="c1"># noqa: PLR2004</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> can only be constructed from a container of 2 elements&quot;</span>
            <span class="p">)</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

        <span class="c1"># __post_init__ will catch cases when the incorrect types for one or both items</span>
        <span class="c1"># is passed, so we can just naively if-else here.</span>
        <span class="n">handler</span><span class="p">:</span> <span class="n">EffectHandler</span>
        <span class="n">options</span><span class="p">:</span> <span class="nb">dict</span>
        <span class="k">if</span> <span class="nb">callable</span><span class="p">(</span><span class="n">pair</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="n">handler</span> <span class="o">=</span> <span class="n">pair</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">options</span> <span class="o">=</span> <span class="n">pair</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">handler</span> <span class="o">=</span> <span class="n">pair</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">options</span> <span class="o">=</span> <span class="n">pair</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">handler</span><span class="o">=</span><span class="n">handler</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="n">options</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Validate set attributes.</span>

<span class="sd">        - The handler is a callable object.</span>
<span class="sd">        - The options have been passed as a dictionary of keyword-value pairs.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">callable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handler</span><span class="p">):</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handler</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not callable.&quot;</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span>
                <span class="s2">&quot;Options should be dictionary mapping option arguments to values &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;(got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">).&quot;</span>
            <span class="p">)</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Equality operation.</span>

<span class="sd">        `HandlerToApply`s are considered equal if they use the same handler function and</span>
<span class="sd">        provide the same options to this function.</span>

<span class="sd">        Comparison to other types returns `False`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">(</span>
            <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">HandlerToApply</span><span class="p">)</span>
            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">handler</span> <span class="ow">is</span> <span class="n">other</span><span class="o">.</span><span class="n">handler</span>
            <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">options</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h5 id="causalprog.causal_problem.handlers.HandlerToApply.__eq__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__eq__</span><span class="p">(</span><span class="n">other</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Equality operation.</p>
<p><code>HandlerToApply</code>s are considered equal if they use the same handler function and
provide the same options to this function.</p>
<p>Comparison to other types returns <code>False</code>.</p>


            <details class="quote">
              <summary>Source code in <code>src/causalprog/causal_problem/handlers.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__eq__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">other</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Equality operation.</span>

<span class="sd">    `HandlerToApply`s are considered equal if they use the same handler function and</span>
<span class="sd">    provide the same options to this function.</span>

<span class="sd">    Comparison to other types returns `False`.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">(</span>
        <span class="nb">isinstance</span><span class="p">(</span><span class="n">other</span><span class="p">,</span> <span class="n">HandlerToApply</span><span class="p">)</span>
        <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">handler</span> <span class="ow">is</span> <span class="n">other</span><span class="o">.</span><span class="n">handler</span>
        <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">options</span> <span class="o">==</span> <span class="n">other</span><span class="o">.</span><span class="n">options</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="causalprog.causal_problem.handlers.HandlerToApply.__post_init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">__post_init__</span><span class="p">()</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Validate set attributes.</p>
<ul>
<li>The handler is a callable object.</li>
<li>The options have been passed as a dictionary of keyword-value pairs.</li>
</ul>


            <details class="quote">
              <summary>Source code in <code>src/causalprog/causal_problem/handlers.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">__post_init__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Validate set attributes.</span>

<span class="sd">    - The handler is a callable object.</span>
<span class="sd">    - The options have been passed as a dictionary of keyword-value pairs.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">callable</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handler</span><span class="p">):</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">handler</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> is not callable.&quot;</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span>
            <span class="s2">&quot;Options should be dictionary mapping option arguments to values &quot;</span>
            <span class="sa">f</span><span class="s2">&quot;(got </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">options</span><span class="p">)</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2">).&quot;</span>
        <span class="p">)</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="causalprog.causal_problem.handlers.HandlerToApply.from_pair" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">from_pair</span><span class="p">(</span><span class="n">pair</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-classmethod"><code>classmethod</code></small>
  </span>

</h5>


    <div class="doc doc-contents ">

        <p>Create an instance from an effect handler and its options.</p>
<p>The two objects should be passed in as the elements of a container of length
2. They can be passed in any order;
- One element must be a dictionary, which will be interpreted as the <code>options</code>
    for the effect handler.
- The other element must be callable, and will be interpreted as the <code>handler</code>
    itself.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>pair</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="collections.abc.Sequence" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Sequence">Sequence</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Container of two elements, one being the effect handler callable and
the other being the options to pass to it (as a dictionary).</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="HandlerToApply


  
      dataclass
   (causalprog.causal_problem.handlers.HandlerToApply)" href="#causalprog.causal_problem.handlers.HandlerToApply">HandlerToApply</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Class instance corresponding to the effect handler and options passed.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/causalprog/causal_problem/handlers.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@classmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">from_pair</span><span class="p">(</span><span class="bp">cls</span><span class="p">,</span> <span class="n">pair</span><span class="p">:</span> <span class="n">Sequence</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="s2">&quot;HandlerToApply&quot;</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create an instance from an effect handler and its options.</span>

<span class="sd">    The two objects should be passed in as the elements of a container of length</span>
<span class="sd">    2. They can be passed in any order;</span>
<span class="sd">    - One element must be a dictionary, which will be interpreted as the `options`</span>
<span class="sd">        for the effect handler.</span>
<span class="sd">    - The other element must be callable, and will be interpreted as the `handler`</span>
<span class="sd">        itself.</span>

<span class="sd">    Args:</span>
<span class="sd">        pair: Container of two elements, one being the effect handler callable and</span>
<span class="sd">            the other being the options to pass to it (as a dictionary).</span>

<span class="sd">    Returns:</span>
<span class="sd">        Class instance corresponding to the effect handler and options passed.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">pair</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>  <span class="c1"># noqa: PLR2004</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">cls</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s2"> can only be constructed from a container of 2 elements&quot;</span>
        <span class="p">)</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

    <span class="c1"># __post_init__ will catch cases when the incorrect types for one or both items</span>
    <span class="c1"># is passed, so we can just naively if-else here.</span>
    <span class="n">handler</span><span class="p">:</span> <span class="n">EffectHandler</span>
    <span class="n">options</span><span class="p">:</span> <span class="nb">dict</span>
    <span class="k">if</span> <span class="nb">callable</span><span class="p">(</span><span class="n">pair</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
        <span class="n">handler</span> <span class="o">=</span> <span class="n">pair</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">options</span> <span class="o">=</span> <span class="n">pair</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">handler</span> <span class="o">=</span> <span class="n">pair</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">options</span> <span class="o">=</span> <span class="n">pair</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">return</span> <span class="bp">cls</span><span class="p">(</span><span class="n">handler</span><span class="o">=</span><span class="n">handler</span><span class="p">,</span> <span class="n">options</span><span class="o">=</span><span class="n">options</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>


  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="causalprog.graph" class="doc doc-heading">
            <code>graph</code>


</h2>

    <div class="doc doc-contents ">

        <p>Creation and storage of graphs.</p>










  <div class="doc doc-children">











<div class="doc doc-object doc-module">



<h3 id="causalprog.graph.graph" class="doc doc-heading">
            <code>graph</code>


</h3>

    <div class="doc doc-contents ">

        <p>Graph storage.</p>










  <div class="doc doc-children">









<div class="doc doc-object doc-class">



<h4 id="causalprog.graph.graph.Graph" class="doc doc-heading">
            <code>Graph</code>


</h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="causalprog._abc.labelled.Labelled">Labelled</span></code></p>


        <p>A directed acyclic graph that represents a causality tree.</p>








              <details class="quote">
                <summary>Source code in <code>src/causalprog/graph/graph.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 10</span>
<span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Graph</span><span class="p">(</span><span class="n">Labelled</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A directed acyclic graph that represents a causality tree.&quot;&quot;&quot;</span>

    <span class="n">_nodes_by_label</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Node</span><span class="p">]</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">label</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">graph</span><span class="p">:</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a graph.</span>

<span class="sd">        Args:</span>
<span class="sd">            label: A label to identify the graph</span>
<span class="sd">            graph: A networkx graph to base this graph on</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_nodes_by_label</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">graph</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">graph</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_graph</span> <span class="o">=</span> <span class="n">graph</span>
        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_nodes_by_label</span><span class="p">[</span><span class="n">node</span><span class="o">.</span><span class="n">label</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">get_node</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Node</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get a node from its label.</span>

<span class="sd">        Args:</span>
<span class="sd">            label: The label</span>

<span class="sd">        Returns:</span>
<span class="sd">            The node</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nodes_by_label</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">node</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;Node not found with label &quot;</span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s1">&quot;&#39;</span>
            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">node</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_node</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">Node</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add a node to the graph.</span>

<span class="sd">        Args:</span>
<span class="sd">            node: The node to add</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">label</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nodes_by_label</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Duplicate node label: </span><span class="si">{</span><span class="n">node</span><span class="o">.</span><span class="n">label</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_nodes_by_label</span><span class="p">[</span><span class="n">node</span><span class="o">.</span><span class="n">label</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_graph</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">add_edge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start_node</span><span class="p">:</span> <span class="n">Node</span> <span class="o">|</span> <span class="nb">str</span><span class="p">,</span> <span class="n">end_node</span><span class="p">:</span> <span class="n">Node</span> <span class="o">|</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add a directed edge to the graph.</span>

<span class="sd">        Adding an edge between nodes not currently in the graph,</span>
<span class="sd">        will cause said nodes to be added to the graph along with</span>
<span class="sd">        the edge.</span>

<span class="sd">        Args:</span>
<span class="sd">            start_node: The node that the edge points from</span>
<span class="sd">            end_node: The node that the edge points to</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">start_node</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">start_node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_node</span><span class="p">(</span><span class="n">start_node</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">end_node</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">end_node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_node</span><span class="p">(</span><span class="n">end_node</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">start_node</span><span class="o">.</span><span class="n">label</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nodes_by_label</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">start_node</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">end_node</span><span class="o">.</span><span class="n">label</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nodes_by_label</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">end_node</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">node_to_check</span> <span class="ow">in</span> <span class="p">(</span><span class="n">start_node</span><span class="p">,</span> <span class="n">end_node</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">node_to_check</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nodes_by_label</span><span class="p">[</span><span class="n">node_to_check</span><span class="o">.</span><span class="n">label</span><span class="p">]:</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Invalid node: </span><span class="si">{node_to_check}</span><span class="s2">&quot;</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_graph</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">start_node</span><span class="p">,</span> <span class="n">end_node</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">parameter_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Node</span><span class="p">,</span> <span class="o">...</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Returns all parameter nodes in the graph.</span>

<span class="sd">        The returned tuple uses the `ordered_nodes` property to obtain the parameter</span>
<span class="sd">        nodes so that a natural &quot;fixed order&quot; is given to the parameters. When parameter</span>
<span class="sd">        values are given as inputs to the causal estimand and / or constraint functions,</span>
<span class="sd">        they will ideally be given as a single vector of parameter values, in which case</span>
<span class="sd">        a fixed ordering for the parameters is necessary to make an association to the</span>
<span class="sd">        components of the given input vector.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Parameter nodes</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">node</span> <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ordered_nodes</span> <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">is_parameter</span><span class="p">)</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">predecessors</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="n">Node</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Node</span><span class="p">,</span> <span class="o">...</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get predecessors of every node.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Mapping of each Node to its predecessor Nodes</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span><span class="n">node</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_graph</span><span class="o">.</span><span class="n">predecessors</span><span class="p">(</span><span class="n">node</span><span class="p">))</span> <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">}</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">successors</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="n">Node</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Node</span><span class="p">,</span> <span class="o">...</span><span class="p">]]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get successors of every node.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Mapping of each Node to its successor Nodes.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span><span class="n">node</span><span class="p">:</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_graph</span><span class="o">.</span><span class="n">successors</span><span class="p">(</span><span class="n">node</span><span class="p">))</span> <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">nodes</span><span class="p">}</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Node</span><span class="p">,</span> <span class="o">...</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the nodes of the graph, with no enforced ordering.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A list of all the nodes in the graph.</span>

<span class="sd">        See Also:</span>
<span class="sd">            ordered_nodes: Fetch an ordered list of the nodes in the graph.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">())</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">edges</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="nb">tuple</span><span class="p">[</span><span class="n">Node</span><span class="p">,</span> <span class="n">Node</span><span class="p">],</span> <span class="o">...</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the edges of the graph.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A tuple of all the edges in the graph.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_graph</span><span class="o">.</span><span class="n">edges</span><span class="p">())</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">ordered_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Node</span><span class="p">,</span> <span class="o">...</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Nodes ordered so that each node appears after its dependencies.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A list of all the nodes, ordered such that each node</span>
<span class="sd">                appears after all its dependencies.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">nx</span><span class="o">.</span><span class="n">is_directed_acyclic_graph</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_graph</span><span class="p">):</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Graph is not acyclic.&quot;</span>
            <span class="k">raise</span> <span class="ne">RuntimeError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">nx</span><span class="o">.</span><span class="n">topological_sort</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_graph</span><span class="p">))</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">ordered_dist_nodes</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Node</span><span class="p">,</span> <span class="o">...</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        `DistributionNode`s in dependency order.</span>

<span class="sd">        Each `DistributionNode` in the returned list appears after all its</span>
<span class="sd">        dependencies. Order is derived from `self.ordered_nodes`, selecting</span>
<span class="sd">        only those nodes where `is_distribution` is `True`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">node</span> <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ordered_nodes</span> <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">is_distribution</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">roots_down_to_outcome</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">outcome_node_label</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Node</span><span class="p">,</span> <span class="o">...</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get ordered list of nodes that outcome depends on.</span>

<span class="sd">        Nodes are ordered so that each node appears after its dependencies.</span>

<span class="sd">        Args:</span>
<span class="sd">            outcome_node_label: The label of the outcome node</span>

<span class="sd">        Returns:</span>
<span class="sd">            A list of the nodes, ordered from root nodes to the outcome Node.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">outcome</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_node</span><span class="p">(</span><span class="n">outcome_node_label</span><span class="p">)</span>
        <span class="n">ancestors</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">ancestors</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_graph</span><span class="p">,</span> <span class="n">outcome</span><span class="p">)</span>
        <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span>
            <span class="n">node</span> <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ordered_nodes</span> <span class="k">if</span> <span class="n">node</span> <span class="o">==</span> <span class="n">outcome</span> <span class="ow">or</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">ancestors</span>
        <span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">parameter_values</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">ArrayLike</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">npt</span><span class="o">.</span><span class="n">ArrayLike</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Model corresponding to the `Graph`&#39;s structure.</span>

<span class="sd">        The model created takes values of the nodes that are parameter as keyword</span>
<span class="sd">        arguments. Names of the keyword arguments should match the labels of the</span>
<span class="sd">        `ParameterNode`s, and their values should be the values of those parameters.</span>

<span class="sd">        The method returns a dictionary recording the mode sites that are created.</span>
<span class="sd">        This means that the model can be &#39;extended&#39; further by defining additional</span>
<span class="sd">        sites in a wrapper around this method.</span>

<span class="sd">        Args:</span>
<span class="sd">            parameter_values: Names of the keyword arguments should match the labels</span>
<span class="sd">                of the `ParameterNode`s, and their values should be the values of those</span>
<span class="sd">                parameters.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Mapping of non-`ParameterNode` `Node` labels to the site objects created</span>
<span class="sd">                for these nodes.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Confirm that all `ParameterNode`s have been assigned a value.</span>
        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameter_nodes</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">label</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">parameter_values</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;ParameterNode &#39;</span><span class="si">{</span><span class="n">node</span><span class="o">.</span><span class="n">label</span><span class="si">}</span><span class="s2">&#39; not assigned&quot;</span>
                <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

        <span class="c1"># Build model sequentially, using the node_order to inform the</span>
        <span class="c1"># construction process.</span>
        <span class="n">node_record</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">npt</span><span class="o">.</span><span class="n">ArrayLike</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ordered_dist_nodes</span><span class="p">:</span>
            <span class="n">node_record</span><span class="p">[</span><span class="n">node</span><span class="o">.</span><span class="n">label</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">create_model_site</span><span class="p">(</span>
                <span class="o">**</span><span class="n">parameter_values</span><span class="p">,</span>  <span class="c1"># All nodes require knowledge of the parameters</span>
                <span class="o">**</span><span class="n">node_record</span><span class="p">,</span>  <span class="c1"># and any dependent nodes we have already visited</span>
            <span class="p">)</span>

        <span class="k">return</span> <span class="n">node_record</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h5 id="causalprog.graph.graph.Graph.edges" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">edges</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h5>


    <div class="doc doc-contents ">

        <p>Get the edges of the graph.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#tuple">tuple</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#tuple">tuple</a>[<a class="autorefs autorefs-internal" title="Node (causalprog.graph.node.Node)" href="#causalprog.graph.node.base.Node">Node</a>, <a class="autorefs autorefs-internal" title="Node (causalprog.graph.node.Node)" href="#causalprog.graph.node.base.Node">Node</a>], ...]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A tuple of all the edges in the graph.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="causalprog.graph.graph.Graph.nodes" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">nodes</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h5>


    <div class="doc doc-contents ">

        <p>Get the nodes of the graph, with no enforced ordering.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#tuple">tuple</a>[<a class="autorefs autorefs-internal" title="Node (causalprog.graph.node.Node)" href="#causalprog.graph.node.base.Node">Node</a>, ...]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of all the nodes in the graph.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


<details class="see-also" open>
  <summary>See Also</summary>
  <p>ordered_nodes: Fetch an ordered list of the nodes in the graph.</p>
</details>
    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="causalprog.graph.graph.Graph.ordered_dist_nodes" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">ordered_dist_nodes</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h5>


    <div class="doc doc-contents ">

        <p><code>DistributionNode</code>s in dependency order.</p>
<p>Each <code>DistributionNode</code> in the returned list appears after all its
dependencies. Order is derived from <code>self.ordered_nodes</code>, selecting
only those nodes where <code>is_distribution</code> is <code>True</code>.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="causalprog.graph.graph.Graph.ordered_nodes" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">ordered_nodes</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h5>


    <div class="doc doc-contents ">

        <p>Nodes ordered so that each node appears after its dependencies.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#tuple">tuple</a>[<a class="autorefs autorefs-internal" title="Node (causalprog.graph.node.Node)" href="#causalprog.graph.node.base.Node">Node</a>, ...]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of all the nodes, ordered such that each node
appears after all its dependencies.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="causalprog.graph.graph.Graph.parameter_nodes" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">parameter_nodes</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h5>


    <div class="doc doc-contents ">

        <p>Returns all parameter nodes in the graph.</p>
<p>The returned tuple uses the <code>ordered_nodes</code> property to obtain the parameter
nodes so that a natural "fixed order" is given to the parameters. When parameter
values are given as inputs to the causal estimand and / or constraint functions,
they will ideally be given as a single vector of parameter values, in which case
a fixed ordering for the parameters is necessary to make an association to the
components of the given input vector.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#tuple">tuple</a>[<a class="autorefs autorefs-internal" title="Node (causalprog.graph.node.Node)" href="#causalprog.graph.node.base.Node">Node</a>, ...]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Parameter nodes</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="causalprog.graph.graph.Graph.predecessors" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">predecessors</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h5>


    <div class="doc doc-contents ">

        <p>Get predecessors of every node.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a>[<a class="autorefs autorefs-internal" title="Node (causalprog.graph.node.Node)" href="#causalprog.graph.node.base.Node">Node</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#tuple">tuple</a>[<a class="autorefs autorefs-internal" title="Node (causalprog.graph.node.Node)" href="#causalprog.graph.node.base.Node">Node</a>, ...]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Mapping of each Node to its predecessor Nodes</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="causalprog.graph.graph.Graph.successors" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">successors</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h5>


    <div class="doc doc-contents ">

        <p>Get successors of every node.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a>[<a class="autorefs autorefs-internal" title="Node (causalprog.graph.node.Node)" href="#causalprog.graph.node.base.Node">Node</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#tuple">tuple</a>[<a class="autorefs autorefs-internal" title="Node (causalprog.graph.node.Node)" href="#causalprog.graph.node.base.Node">Node</a>, ...]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Mapping of each Node to its successor Nodes.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>




<div class="doc doc-object doc-function">


<h5 id="causalprog.graph.graph.Graph.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">graph</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Create a graph.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>label</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A label to identify the graph</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>graph</code>
            </td>
            <td>
                  <code><span title="networkx.DiGraph">DiGraph</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A networkx graph to base this graph on</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/causalprog/graph/graph.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">label</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">graph</span><span class="p">:</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a graph.</span>

<span class="sd">    Args:</span>
<span class="sd">        label: A label to identify the graph</span>
<span class="sd">        graph: A networkx graph to base this graph on</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_nodes_by_label</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="n">graph</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">graph</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">DiGraph</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_graph</span> <span class="o">=</span> <span class="n">graph</span>
    <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">graph</span><span class="o">.</span><span class="n">nodes</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_nodes_by_label</span><span class="p">[</span><span class="n">node</span><span class="o">.</span><span class="n">label</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="causalprog.graph.graph.Graph.add_edge" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_edge</span><span class="p">(</span><span class="n">start_node</span><span class="p">,</span> <span class="n">end_node</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Add a directed edge to the graph.</p>
<p>Adding an edge between nodes not currently in the graph,
will cause said nodes to be added to the graph along with
the edge.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>start_node</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Node (causalprog.graph.node.Node)" href="#causalprog.graph.node.base.Node">Node</a> | <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The node that the edge points from</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>end_node</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Node (causalprog.graph.node.Node)" href="#causalprog.graph.node.base.Node">Node</a> | <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The node that the edge points to</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/causalprog/graph/graph.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">add_edge</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start_node</span><span class="p">:</span> <span class="n">Node</span> <span class="o">|</span> <span class="nb">str</span><span class="p">,</span> <span class="n">end_node</span><span class="p">:</span> <span class="n">Node</span> <span class="o">|</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Add a directed edge to the graph.</span>

<span class="sd">    Adding an edge between nodes not currently in the graph,</span>
<span class="sd">    will cause said nodes to be added to the graph along with</span>
<span class="sd">    the edge.</span>

<span class="sd">    Args:</span>
<span class="sd">        start_node: The node that the edge points from</span>
<span class="sd">        end_node: The node that the edge points to</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">start_node</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">start_node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_node</span><span class="p">(</span><span class="n">start_node</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">end_node</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
        <span class="n">end_node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_node</span><span class="p">(</span><span class="n">end_node</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">start_node</span><span class="o">.</span><span class="n">label</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nodes_by_label</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">start_node</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">end_node</span><span class="o">.</span><span class="n">label</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nodes_by_label</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">end_node</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">node_to_check</span> <span class="ow">in</span> <span class="p">(</span><span class="n">start_node</span><span class="p">,</span> <span class="n">end_node</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">node_to_check</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nodes_by_label</span><span class="p">[</span><span class="n">node_to_check</span><span class="o">.</span><span class="n">label</span><span class="p">]:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="s2">&quot;Invalid node: </span><span class="si">{node_to_check}</span><span class="s2">&quot;</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_graph</span><span class="o">.</span><span class="n">add_edge</span><span class="p">(</span><span class="n">start_node</span><span class="p">,</span> <span class="n">end_node</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="causalprog.graph.graph.Graph.add_node" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">add_node</span><span class="p">(</span><span class="n">node</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Add a node to the graph.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>node</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-internal" title="Node (causalprog.graph.node.Node)" href="#causalprog.graph.node.base.Node">Node</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The node to add</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/causalprog/graph/graph.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">add_node</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">node</span><span class="p">:</span> <span class="n">Node</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Add a node to the graph.</span>

<span class="sd">    Args:</span>
<span class="sd">        node: The node to add</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">label</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nodes_by_label</span><span class="p">:</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Duplicate node label: </span><span class="si">{</span><span class="n">node</span><span class="o">.</span><span class="n">label</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_nodes_by_label</span><span class="p">[</span><span class="n">node</span><span class="o">.</span><span class="n">label</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_graph</span><span class="o">.</span><span class="n">add_node</span><span class="p">(</span><span class="n">node</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="causalprog.graph.graph.Graph.get_node" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">get_node</span><span class="p">(</span><span class="n">label</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Get a node from its label.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>label</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The label</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="Node (causalprog.graph.node.Node)" href="#causalprog.graph.node.base.Node">Node</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The node</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/causalprog/graph/graph.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">get_node</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">label</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Node</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get a node from its label.</span>

<span class="sd">    Args:</span>
<span class="sd">        label: The label</span>

<span class="sd">    Returns:</span>
<span class="sd">        The node</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">node</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_nodes_by_label</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">node</span><span class="p">:</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;Node not found with label &quot;</span><span class="si">{</span><span class="n">label</span><span class="si">}</span><span class="s1">&quot;&#39;</span>
        <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">node</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="causalprog.graph.graph.Graph.model" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">model</span><span class="p">(</span><span class="o">**</span><span class="n">parameter_values</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Model corresponding to the <code>Graph</code>'s structure.</p>
<p>The model created takes values of the nodes that are parameter as keyword
arguments. Names of the keyword arguments should match the labels of the
<code>ParameterNode</code>s, and their values should be the values of those parameters.</p>
<p>The method returns a dictionary recording the mode sites that are created.
This means that the model can be 'extended' further by defining additional
sites in a wrapper around this method.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>parameter_values</code>
            </td>
            <td>
                  <code><span title="numpy.typing.ArrayLike">ArrayLike</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Names of the keyword arguments should match the labels
of the <code>ParameterNode</code>s, and their values should be the values of those
parameters.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <span title="numpy.typing.ArrayLike">ArrayLike</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Mapping of non-<code>ParameterNode</code> <code>Node</code> labels to the site objects created
for these nodes.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/causalprog/graph/graph.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">model</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">parameter_values</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">ArrayLike</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">npt</span><span class="o">.</span><span class="n">ArrayLike</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Model corresponding to the `Graph`&#39;s structure.</span>

<span class="sd">    The model created takes values of the nodes that are parameter as keyword</span>
<span class="sd">    arguments. Names of the keyword arguments should match the labels of the</span>
<span class="sd">    `ParameterNode`s, and their values should be the values of those parameters.</span>

<span class="sd">    The method returns a dictionary recording the mode sites that are created.</span>
<span class="sd">    This means that the model can be &#39;extended&#39; further by defining additional</span>
<span class="sd">    sites in a wrapper around this method.</span>

<span class="sd">    Args:</span>
<span class="sd">        parameter_values: Names of the keyword arguments should match the labels</span>
<span class="sd">            of the `ParameterNode`s, and their values should be the values of those</span>
<span class="sd">            parameters.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Mapping of non-`ParameterNode` `Node` labels to the site objects created</span>
<span class="sd">            for these nodes.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Confirm that all `ParameterNode`s have been assigned a value.</span>
    <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameter_nodes</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">node</span><span class="o">.</span><span class="n">label</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">parameter_values</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;ParameterNode &#39;</span><span class="si">{</span><span class="n">node</span><span class="o">.</span><span class="n">label</span><span class="si">}</span><span class="s2">&#39; not assigned&quot;</span>
            <span class="k">raise</span> <span class="ne">KeyError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

    <span class="c1"># Build model sequentially, using the node_order to inform the</span>
    <span class="c1"># construction process.</span>
    <span class="n">node_record</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">npt</span><span class="o">.</span><span class="n">ArrayLike</span><span class="p">]</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ordered_dist_nodes</span><span class="p">:</span>
        <span class="n">node_record</span><span class="p">[</span><span class="n">node</span><span class="o">.</span><span class="n">label</span><span class="p">]</span> <span class="o">=</span> <span class="n">node</span><span class="o">.</span><span class="n">create_model_site</span><span class="p">(</span>
            <span class="o">**</span><span class="n">parameter_values</span><span class="p">,</span>  <span class="c1"># All nodes require knowledge of the parameters</span>
            <span class="o">**</span><span class="n">node_record</span><span class="p">,</span>  <span class="c1"># and any dependent nodes we have already visited</span>
        <span class="p">)</span>

    <span class="k">return</span> <span class="n">node_record</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="causalprog.graph.graph.Graph.roots_down_to_outcome" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">roots_down_to_outcome</span><span class="p">(</span><span class="n">outcome_node_label</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Get ordered list of nodes that outcome depends on.</p>
<p>Nodes are ordered so that each node appears after its dependencies.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>outcome_node_label</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The label of the outcome node</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#tuple">tuple</a>[<a class="autorefs autorefs-internal" title="Node (causalprog.graph.node.Node)" href="#causalprog.graph.node.base.Node">Node</a>, ...]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A list of the nodes, ordered from root nodes to the outcome Node.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/causalprog/graph/graph.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">roots_down_to_outcome</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">outcome_node_label</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">tuple</span><span class="p">[</span><span class="n">Node</span><span class="p">,</span> <span class="o">...</span><span class="p">]:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get ordered list of nodes that outcome depends on.</span>

<span class="sd">    Nodes are ordered so that each node appears after its dependencies.</span>

<span class="sd">    Args:</span>
<span class="sd">        outcome_node_label: The label of the outcome node</span>

<span class="sd">    Returns:</span>
<span class="sd">        A list of the nodes, ordered from root nodes to the outcome Node.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">outcome</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_node</span><span class="p">(</span><span class="n">outcome_node_label</span><span class="p">)</span>
    <span class="n">ancestors</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">ancestors</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_graph</span><span class="p">,</span> <span class="n">outcome</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">tuple</span><span class="p">(</span>
        <span class="n">node</span> <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">ordered_nodes</span> <span class="k">if</span> <span class="n">node</span> <span class="o">==</span> <span class="n">outcome</span> <span class="ow">or</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">ancestors</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="causalprog.graph.node" class="doc doc-heading">
            <code>node</code>


</h3>

    <div class="doc doc-contents ">

        <p>Graph nodes.</p>










  <div class="doc doc-children">











<div class="doc doc-object doc-module">



<h4 id="causalprog.graph.node.base" class="doc doc-heading">
            <code>base</code>


</h4>

    <div class="doc doc-contents ">

        <p>Base graph node.</p>










  <div class="doc doc-children">









<div class="doc doc-object doc-class">



<h5 id="causalprog.graph.node.base.Node" class="doc doc-heading">
            <code>Node</code>


</h5>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><span title="causalprog._abc.labelled.Labelled">Labelled</span></code></p>


        <p>An abstract node in a graph.</p>








              <details class="quote">
                <summary>Source code in <code>src/causalprog/graph/node/base.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Node</span><span class="p">(</span><span class="n">Labelled</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;An abstract node in a graph.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">label</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">is_parameter</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
        <span class="n">is_distribution</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialise.</span>

<span class="sd">        Parameters (equivalently `ParameterNode`s) represent Nodes that do not have</span>
<span class="sd">        random variables attached. Instead, these nodes represent values that are passed</span>
<span class="sd">        to nodes that _do_ have distributions attached, and the value of the &quot;parameter&quot;</span>
<span class="sd">        node is used as a fixed value when constructing the dependent node&#39;s</span>
<span class="sd">        distribution. The set of parameter nodes is the collection of &quot;parameter&quot;s over</span>
<span class="sd">        which one should want to optimise the causal estimand (subject to any</span>
<span class="sd">        constraints), and as such the value that a &quot;parameter node&quot; passes to its</span>
<span class="sd">        dependent nodes will vary as the optimiser runs and explores the solution space.</span>

<span class="sd">        Note that a &quot;constant parameter&quot; is distinct from a &quot;parameter&quot; in the sense</span>
<span class="sd">        that a constant parameter is _not_ added to the collection of parameters over</span>
<span class="sd">        which we will want to optimise (it is a hard-coded, fixed value).</span>

<span class="sd">        Distributions (equivalently `DistributionNode`s) are Nodes that represent</span>
<span class="sd">        random variables described by probability distributions.</span>

<span class="sd">        Args:</span>
<span class="sd">            label: A unique label to identify the node</span>
<span class="sd">            is_parameter: Is the node a parameter?</span>
<span class="sd">            is_distribution: Is the node a distribution?</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_parameter</span> <span class="o">=</span> <span class="n">is_parameter</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_distribution</span> <span class="o">=</span> <span class="n">is_distribution</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">sample</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">parameter_values</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
        <span class="n">sampled_dependencies</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="nb">float</span><span class="p">]],</span>
        <span class="n">samples</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">rng_key</span><span class="p">:</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sample a value from the node.</span>

<span class="sd">        Args:</span>
<span class="sd">            parameter_values: Values to be taken by parameters</span>
<span class="sd">            sampled_dependencies: Values taken by dependencies of this node</span>
<span class="sd">            samples: Number of samples</span>
<span class="sd">            rng_key: Random key</span>

<span class="sd">        Returns:</span>
<span class="sd">            Sample value of this node</span>

<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@abstractmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Node</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Make a copy of a node.</span>

<span class="sd">        Some inner objects stored inside the node may not be copied when this is called.</span>
<span class="sd">        Modifying some inner objects of a copy made using this may affect the original</span>
<span class="sd">        node.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A copy of the node</span>

<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">is_parameter</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Identify if the node is an parameter.</span>

<span class="sd">        Returns:</span>
<span class="sd">            True if the node is an parameter</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_parameter</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">is_distribution</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Identify if the node is an distribution.</span>

<span class="sd">        Returns:</span>
<span class="sd">            True if the node is an distribution</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_distribution</span>

    <span class="nd">@property</span>
    <span class="nd">@abstractmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">constant_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Named constants that this node depends on.</span>

<span class="sd">        Returns:</span>
<span class="sd">            A dictionary of the constant parameter names (keys) and their corresponding</span>
<span class="sd">            values</span>

<span class="sd">        &quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="nd">@abstractmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Mapping of distribution parameter names to the nodes they are represented by.</span>

<span class="sd">        Returns:</span>
<span class="sd">            Mapping of distribution parameters (keys) to the corresponding label of the</span>
<span class="sd">            node that represents this parameter (value).</span>

<span class="sd">        &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h6 id="causalprog.graph.node.base.Node.constant_parameters" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">constant_parameters</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h6>


    <div class="doc doc-contents ">

        <p>Named constants that this node depends on.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary of the constant parameter names (keys) and their corresponding</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>values</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h6 id="causalprog.graph.node.base.Node.is_distribution" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_distribution</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h6>


    <div class="doc doc-contents ">

        <p>Identify if the node is an distribution.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if the node is an distribution</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h6 id="causalprog.graph.node.base.Node.is_parameter" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">is_parameter</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h6>


    <div class="doc doc-contents ">

        <p>Identify if the node is an parameter.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>True if the node is an parameter</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h6 id="causalprog.graph.node.base.Node.parameters" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">parameters</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h6>


    <div class="doc doc-contents ">

        <p>Mapping of distribution parameter names to the nodes they are represented by.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Mapping of distribution parameters (keys) to the corresponding label of the</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>node that represents this parameter (value).</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>

    </div>

</div>




<div class="doc doc-object doc-function">


<h6 id="causalprog.graph.node.base.Node.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">is_parameter</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">is_distribution</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

</h6>


    <div class="doc doc-contents ">

        <p>Initialise.</p>
<p>Parameters (equivalently <code>ParameterNode</code>s) represent Nodes that do not have
random variables attached. Instead, these nodes represent values that are passed
to nodes that <em>do</em> have distributions attached, and the value of the "parameter"
node is used as a fixed value when constructing the dependent node's
distribution. The set of parameter nodes is the collection of "parameter"s over
which one should want to optimise the causal estimand (subject to any
constraints), and as such the value that a "parameter node" passes to its
dependent nodes will vary as the optimiser runs and explores the solution space.</p>
<p>Note that a "constant parameter" is distinct from a "parameter" in the sense
that a constant parameter is <em>not</em> added to the collection of parameters over
which we will want to optimise (it is a hard-coded, fixed value).</p>
<p>Distributions (equivalently <code>DistributionNode</code>s) are Nodes that represent
random variables described by probability distributions.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>label</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A unique label to identify the node</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>is_parameter</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Is the node a parameter?</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>is_distribution</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Is the node a distribution?</p>
              </div>
            </td>
            <td>
                  <code>False</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/causalprog/graph/node/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">label</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">is_parameter</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
    <span class="n">is_distribution</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initialise.</span>

<span class="sd">    Parameters (equivalently `ParameterNode`s) represent Nodes that do not have</span>
<span class="sd">    random variables attached. Instead, these nodes represent values that are passed</span>
<span class="sd">    to nodes that _do_ have distributions attached, and the value of the &quot;parameter&quot;</span>
<span class="sd">    node is used as a fixed value when constructing the dependent node&#39;s</span>
<span class="sd">    distribution. The set of parameter nodes is the collection of &quot;parameter&quot;s over</span>
<span class="sd">    which one should want to optimise the causal estimand (subject to any</span>
<span class="sd">    constraints), and as such the value that a &quot;parameter node&quot; passes to its</span>
<span class="sd">    dependent nodes will vary as the optimiser runs and explores the solution space.</span>

<span class="sd">    Note that a &quot;constant parameter&quot; is distinct from a &quot;parameter&quot; in the sense</span>
<span class="sd">    that a constant parameter is _not_ added to the collection of parameters over</span>
<span class="sd">    which we will want to optimise (it is a hard-coded, fixed value).</span>

<span class="sd">    Distributions (equivalently `DistributionNode`s) are Nodes that represent</span>
<span class="sd">    random variables described by probability distributions.</span>

<span class="sd">    Args:</span>
<span class="sd">        label: A unique label to identify the node</span>
<span class="sd">        is_parameter: Is the node a parameter?</span>
<span class="sd">        is_distribution: Is the node a distribution?</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_is_parameter</span> <span class="o">=</span> <span class="n">is_parameter</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_is_distribution</span> <span class="o">=</span> <span class="n">is_distribution</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="causalprog.graph.node.base.Node.copy" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">copy</span><span class="p">()</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h6>


    <div class="doc doc-contents ">

        <p>Make a copy of a node.</p>
<p>Some inner objects stored inside the node may not be copied when this is called.
Modifying some inner objects of a copy made using this may affect the original
node.</p>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="Node (causalprog.graph.node.base.Node)" href="#causalprog.graph.node.base.Node">Node</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A copy of the node</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/causalprog/graph/node/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abstractmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Node</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Make a copy of a node.</span>

<span class="sd">    Some inner objects stored inside the node may not be copied when this is called.</span>
<span class="sd">    Modifying some inner objects of a copy made using this may affect the original</span>
<span class="sd">    node.</span>

<span class="sd">    Returns:</span>
<span class="sd">        A copy of the node</span>

<span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="causalprog.graph.node.base.Node.sample" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">sample</span><span class="p">(</span><span class="n">parameter_values</span><span class="p">,</span> <span class="n">sampled_dependencies</span><span class="p">,</span> <span class="n">samples</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">rng_key</span><span class="p">)</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
  </span>

</h6>


    <div class="doc doc-contents ">

        <p>Sample a value from the node.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>parameter_values</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Values to be taken by parameters</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>sampled_dependencies</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <span title="numpy.typing.NDArray">NDArray</span>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a>]]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Values taken by dependencies of this node</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>samples</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of samples</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>rng_key</code>
            </td>
            <td>
                  <code><span title="jax.Array">Array</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Random key</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Sample value of this node</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/causalprog/graph/node/base.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@abstractmethod</span>
<span class="k">def</span><span class="w"> </span><span class="nf">sample</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">parameter_values</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
    <span class="n">sampled_dependencies</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="nb">float</span><span class="p">]],</span>
    <span class="n">samples</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">rng_key</span><span class="p">:</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">float</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Sample a value from the node.</span>

<span class="sd">    Args:</span>
<span class="sd">        parameter_values: Values to be taken by parameters</span>
<span class="sd">        sampled_dependencies: Values taken by dependencies of this node</span>
<span class="sd">        samples: Number of samples</span>
<span class="sd">        rng_key: Random key</span>

<span class="sd">    Returns:</span>
<span class="sd">        Sample value of this node</span>

<span class="sd">    &quot;&quot;&quot;</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h4 id="causalprog.graph.node.distribution" class="doc doc-heading">
            <code>distribution</code>


</h4>

    <div class="doc doc-contents ">

        <p>Graph nodes representing distributions.</p>










  <div class="doc doc-children">









<div class="doc doc-object doc-class">



<h5 id="causalprog.graph.node.distribution.DistributionNode" class="doc doc-heading">
            <code>DistributionNode</code>


</h5>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="Node (causalprog.graph.node.base.Node)" href="#causalprog.graph.node.base.Node">Node</a></code></p>


        <p>A node containing a distribution.</p>








              <details class="quote">
                <summary>Source code in <code>src/causalprog/graph/node/distribution.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">DistributionNode</span><span class="p">(</span><span class="n">Node</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A node containing a distribution.&quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">distribution</span><span class="p">:</span> <span class="nb">type</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">label</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
        <span class="n">parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">constant_parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialise.</span>

<span class="sd">        Args:</span>
<span class="sd">            distribution: The distribution</span>
<span class="sd">            label: A unique label to identify the node</span>
<span class="sd">            parameters: A dictionary of parameters</span>
<span class="sd">            constant_parameters: A dictionary of constant parameters</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dist</span> <span class="o">=</span> <span class="n">distribution</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_constant_parameters</span> <span class="o">=</span> <span class="n">constant_parameters</span> <span class="k">if</span> <span class="n">constant_parameters</span> <span class="k">else</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span> <span class="o">=</span> <span class="n">parameters</span> <span class="k">if</span> <span class="n">parameters</span> <span class="k">else</span> <span class="p">{}</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span> <span class="n">is_distribution</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="nd">@override</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">sample</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">parameter_values</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
        <span class="n">sampled_dependencies</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="nb">float</span><span class="p">]],</span>
        <span class="n">samples</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">rng_key</span><span class="p">:</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
        <span class="n">d</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dist</span><span class="p">(</span>
            <span class="c1"># Pass in node values derived from construction so far</span>
            <span class="o">**</span><span class="p">{</span>
                <span class="n">native_name</span><span class="p">:</span> <span class="n">sampled_dependencies</span><span class="p">[</span><span class="n">node_name</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">native_name</span><span class="p">,</span> <span class="n">node_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="p">},</span>
            <span class="c1"># Pass in any constant parameters this node sets</span>
            <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">constant_parameters</span><span class="p">,</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="n">numpyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">,</span>
            <span class="n">d</span><span class="p">,</span>
            <span class="n">rng_key</span><span class="o">=</span><span class="n">rng_key</span><span class="p">,</span>
            <span class="n">sample_shape</span><span class="o">=</span><span class="p">(</span><span class="n">samples</span><span class="p">,)</span> <span class="k">if</span> <span class="n">d</span><span class="o">.</span><span class="n">batch_shape</span> <span class="o">==</span> <span class="p">()</span> <span class="ow">and</span> <span class="n">samples</span> <span class="o">&gt;</span> <span class="mi">1</span> <span class="k">else</span> <span class="p">(),</span>
        <span class="p">)</span>

    <span class="nd">@override</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Node</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">DistributionNode</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_dist</span><span class="p">,</span>
            <span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">,</span>
            <span class="n">parameters</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">),</span>
            <span class="n">constant_parameters</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_constant_parameters</span><span class="o">.</span><span class="n">items</span><span class="p">()),</span>
        <span class="p">)</span>

    <span class="nd">@override</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">r</span> <span class="o">=</span> <span class="sa">f</span><span class="s1">&#39;DistributionNode(</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_dist</span><span class="o">.</span><span class="vm">__name__</span><span class="si">}</span><span class="s1">, label=&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="si">}</span><span class="s1">&quot;&#39;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">r</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;, parameters=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_constant_parameters</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">r</span> <span class="o">+=</span> <span class="sa">f</span><span class="s2">&quot;, constant_parameters=</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">_constant_parameters</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="n">r</span>

    <span class="nd">@override</span>
    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">constant_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_constant_parameters</span>

    <span class="nd">@override</span>
    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">create_model_site</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">dependent_nodes</span><span class="p">:</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">npt</span><span class="o">.</span><span class="n">ArrayLike</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a model site for the (conditional) distribution attached to this node.</span>

<span class="sd">        `dependent_nodes` should contain keyword arguments mapping dependent node names</span>
<span class="sd">        to the values that those nodes are taking (`ParameterNode`s), or the sampling</span>
<span class="sd">        object for those nodes (`DistributionNode`s). These are passed to</span>
<span class="sd">        `self._dist` as keyword arguments to construct the sample-able object</span>
<span class="sd">        representing this node.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">numpyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_dist</span><span class="p">(</span>
                <span class="c1"># Pass in node values derived from construction so far</span>
                <span class="o">**</span><span class="p">{</span>
                    <span class="n">native_name</span><span class="p">:</span> <span class="n">dependent_nodes</span><span class="p">[</span><span class="n">node_name</span><span class="p">]</span>
                    <span class="k">for</span> <span class="n">native_name</span><span class="p">,</span> <span class="n">node_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
                <span class="p">},</span>
                <span class="c1"># Pass in any constant parameters this node sets</span>
                <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">constant_parameters</span><span class="p">,</span>
            <span class="p">),</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h6 id="causalprog.graph.node.distribution.DistributionNode.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">distribution</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">label</span><span class="p">,</span> <span class="n">parameters</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">constant_parameters</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

</h6>


    <div class="doc doc-contents ">

        <p>Initialise.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>distribution</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#type">type</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The distribution</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>label</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A unique label to identify the node</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>parameters</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary of parameters</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>constant_parameters</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a>[<a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a>, <a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A dictionary of constant parameters</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/causalprog/graph/node/distribution.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">distribution</span><span class="p">:</span> <span class="nb">type</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">label</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">constant_parameters</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initialise.</span>

<span class="sd">    Args:</span>
<span class="sd">        distribution: The distribution</span>
<span class="sd">        label: A unique label to identify the node</span>
<span class="sd">        parameters: A dictionary of parameters</span>
<span class="sd">        constant_parameters: A dictionary of constant parameters</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_dist</span> <span class="o">=</span> <span class="n">distribution</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_constant_parameters</span> <span class="o">=</span> <span class="n">constant_parameters</span> <span class="k">if</span> <span class="n">constant_parameters</span> <span class="k">else</span> <span class="p">{}</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">_parameters</span> <span class="o">=</span> <span class="n">parameters</span> <span class="k">if</span> <span class="n">parameters</span> <span class="k">else</span> <span class="p">{}</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span> <span class="n">is_distribution</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h6 id="causalprog.graph.node.distribution.DistributionNode.create_model_site" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">create_model_site</span><span class="p">(</span><span class="o">**</span><span class="n">dependent_nodes</span><span class="p">)</span></code>

</h6>


    <div class="doc doc-contents ">

        <p>Create a model site for the (conditional) distribution attached to this node.</p>
<p><code>dependent_nodes</code> should contain keyword arguments mapping dependent node names
to the values that those nodes are taking (<code>ParameterNode</code>s), or the sampling
object for those nodes (<code>DistributionNode</code>s). These are passed to
<code>self._dist</code> as keyword arguments to construct the sample-able object
representing this node.</p>


            <details class="quote">
              <summary>Source code in <code>src/causalprog/graph/node/distribution.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">create_model_site</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">dependent_nodes</span><span class="p">:</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">npt</span><span class="o">.</span><span class="n">ArrayLike</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a model site for the (conditional) distribution attached to this node.</span>

<span class="sd">    `dependent_nodes` should contain keyword arguments mapping dependent node names</span>
<span class="sd">    to the values that those nodes are taking (`ParameterNode`s), or the sampling</span>
<span class="sd">    object for those nodes (`DistributionNode`s). These are passed to</span>
<span class="sd">    `self._dist` as keyword arguments to construct the sample-able object</span>
<span class="sd">    representing this node.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">numpyro</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dist</span><span class="p">(</span>
            <span class="c1"># Pass in node values derived from construction so far</span>
            <span class="o">**</span><span class="p">{</span>
                <span class="n">native_name</span><span class="p">:</span> <span class="n">dependent_nodes</span><span class="p">[</span><span class="n">node_name</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">native_name</span><span class="p">,</span> <span class="n">node_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">parameters</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
            <span class="p">},</span>
            <span class="c1"># Pass in any constant parameters this node sets</span>
            <span class="o">**</span><span class="bp">self</span><span class="o">.</span><span class="n">constant_parameters</span><span class="p">,</span>
        <span class="p">),</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h4 id="causalprog.graph.node.parameter" class="doc doc-heading">
            <code>parameter</code>


</h4>

    <div class="doc doc-contents ">

        <p>Graph nodes representing parameters.</p>










  <div class="doc doc-children">









<div class="doc doc-object doc-class">



<h5 id="causalprog.graph.node.parameter.ParameterNode" class="doc doc-heading">
            <code>ParameterNode</code>


</h5>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-internal" title="Node (causalprog.graph.node.base.Node)" href="#causalprog.graph.node.base.Node">Node</a></code></p>


        <p>A node containing a parameter.</p>
<p><code>ParameterNode</code>s differ from <code>DistributionNode</code>s in that they do not have an
attached distribution, but rather represent a parameter that contributes
to the shape of one (or more) <code>DistributionNode</code>s.</p>
<p>The collection of parameters described by <code>ParameterNode</code>s forms the set of
variables that will be optimised over in the corresponding <code>CausalProblem</code>.</p>
<p><code>ParameterNode</code>s should not be used to encode constant values used by
<code>DistributionNode</code>s. Such constant values should be given to the necessary
<code>DistributionNode</code>s directly as <code>constant_parameters</code>.</p>








              <details class="quote">
                <summary>Source code in <code>src/causalprog/graph/node/parameter.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">ParameterNode</span><span class="p">(</span><span class="n">Node</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A node containing a parameter.</span>

<span class="sd">    `ParameterNode`s differ from `DistributionNode`s in that they do not have an</span>
<span class="sd">    attached distribution, but rather represent a parameter that contributes</span>
<span class="sd">    to the shape of one (or more) `DistributionNode`s.</span>

<span class="sd">    The collection of parameters described by `ParameterNode`s forms the set of</span>
<span class="sd">    variables that will be optimised over in the corresponding `CausalProblem`.</span>

<span class="sd">    `ParameterNode`s should not be used to encode constant values used by</span>
<span class="sd">    `DistributionNode`s. Such constant values should be given to the necessary</span>
<span class="sd">    `DistributionNode`s directly as `constant_parameters`.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">label</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialise.</span>

<span class="sd">        Args:</span>
<span class="sd">            label: A unique label to identify the node</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span> <span class="n">is_parameter</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="nd">@override</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">sample</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">parameter_values</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">],</span>
        <span class="n">sampled_dependencies</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="nb">float</span><span class="p">]],</span>
        <span class="n">samples</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
        <span class="o">*</span><span class="p">,</span>
        <span class="n">rng_key</span><span class="p">:</span> <span class="n">jax</span><span class="o">.</span><span class="n">Array</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">npt</span><span class="o">.</span><span class="n">NDArray</span><span class="p">[</span><span class="nb">float</span><span class="p">]:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">label</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">parameter_values</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Missing input for parameter node: </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="si">}</span><span class="s2">.&quot;</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">samples</span><span class="p">,</span> <span class="n">parameter_values</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">])</span>

    <span class="nd">@override</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">copy</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Node</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">ParameterNode</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="p">)</span>

    <span class="nd">@override</span>
    <span class="k">def</span><span class="w"> </span><span class="fm">__repr__</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
        <span class="k">return</span> <span class="sa">f</span><span class="s1">&#39;ParameterNode(label=&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">label</span><span class="si">}</span><span class="s1">&quot;)&#39;</span>

    <span class="nd">@override</span>
    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">constant_parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">float</span><span class="p">]:</span>
        <span class="k">return</span> <span class="p">{}</span>

    <span class="nd">@override</span>
    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">parameters</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]:</span>
        <span class="k">return</span> <span class="p">{}</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h6 id="causalprog.graph.node.parameter.ParameterNode.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span></code>

</h6>


    <div class="doc doc-contents ">

        <p>Initialise.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>label</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>A unique label to identify the node</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/causalprog/graph/node/parameter.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">label</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Initialise.</span>

<span class="sd">    Args:</span>
<span class="sd">        label: A unique label to identify the node</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">label</span><span class="o">=</span><span class="n">label</span><span class="p">,</span> <span class="n">is_parameter</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>


  </div>

    </div>

</div>


  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="causalprog.solvers" class="doc doc-heading">
            <code>solvers</code>


</h2>

    <div class="doc doc-contents ">

        <p>Solvers for Causal Problems.</p>










  <div class="doc doc-children">











<div class="doc doc-object doc-module">



<h3 id="causalprog.solvers.sgd" class="doc doc-heading">
            <code>sgd</code>


</h3>

    <div class="doc doc-contents ">

        <p>Minimisation via Stochastic Gradient Descent.</p>










  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="causalprog.solvers.sgd.stochastic_gradient_descent" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">stochastic_gradient_descent</span><span class="p">(</span><span class="n">obj_fn</span><span class="p">,</span> <span class="n">initial_guess</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">convergence_criteria</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fn_args</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">fn_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">maxiter</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">optimiser</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="mf">1e-08</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Minimise a function of one argument using Stochastic Gradient Descent (SGD).</p>
<p>The <code>obj_fn</code> provided will be minimised over its first argument. If you wish to
minimise a function over a different argument, or multiple arguments, wrap it in a
suitable <code>lambda</code> expression that has the correct call signature. For example, to
minimise a function <code>f(x, y, z)</code> over <code>y</code> and <code>z</code>, use
<code>g = lambda yz, x: f(x, yz[0], yz[1])</code>, and pass <code>g</code> in as <code>obj_fn</code>. Note that
you will also need to provide a constant value for <code>x</code> via <code>fn_args</code> or <code>fn_kwargs</code>.</p>
<p>The <code>fn_args</code> and <code>fn_kwargs</code> keys can be used to supply additional parameters that
need to be passed to <code>obj_fn</code>, but which should be held constant.</p>
<p>SGD terminates when the <code>convergence_criteria</code> is found to be smaller than the
<code>tolerance</code>. That is, when
<code>convergence_criteria(objective_value, gradient_value) &lt;= tolerance</code> is found to
be <code>True</code>, the algorithm considers a minimum to have been found. The default
condition under which the algorithm terminates is when the norm of the gradient
at the current argument value is smaller than the provided <code>tolerance</code>.</p>
<p>The optimiser to use can be selected by passing in a suitable <code>optax</code> optimiser
via the <code>optimiser</code> command. By default, <code>optax.adams</code> is used with the supplied
<code>learning_rate</code>. Providing an explicit value for <code>optimiser</code> will result in the
<code>learning_rate</code> argument being ignored.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>obj_fn</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="collections.abc.Callable" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Callable">Callable</a>[[<span title="causalprog.utils.norms.PyTree">PyTree</span>], <span title="numpy.typing.ArrayLike">ArrayLike</span>]</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Function to be minimised over its first argument.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>initial_guess</code>
            </td>
            <td>
                  <code><span title="causalprog.utils.norms.PyTree">PyTree</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Initial guess for the minimising argument.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>convergence_criteria</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" title="collections.abc.Callable" href="https://docs.python.org/3/library/collections.abc.html#collections.abc.Callable">Callable</a>[[<span title="causalprog.utils.norms.PyTree">PyTree</span>, <span title="causalprog.utils.norms.PyTree">PyTree</span>], <span title="numpy.typing.ArrayLike">ArrayLike</span>] | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The quantity that will be tested against <code>tolerance</code>, to
determine whether the method has converged to a minimum. It should be a
<code>callable</code> that takes the current value of <code>obj_fn</code> as its 1st argument, and
the current value of the gradient of <code>obj_fn</code> as its 2nd argument. The
default criteria is the l2-norm of the gradient.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fn_args</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#tuple">tuple</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Positional arguments to be passed to <code>obj_fn</code>, and held constant.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>fn_kwargs</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#dict">dict</a> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Keyword arguments to be passed to <code>obj_fn</code>, and held constant.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>learning_rate</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Default learning rate (or step size) to use when using the
default <code>optimiser</code>. No effect if <code>optimiser</code> is provided explicitly.</p>
              </div>
            </td>
            <td>
                  <code>0.1</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>maxiter</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum number of iterations to perform. An error will be reported if
this number of iterations is exceeded.</p>
              </div>
            </td>
            <td>
                  <code>1000</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>optimiser</code>
            </td>
            <td>
                  <code><span title="optax.GradientTransformationExtraArgs">GradientTransformationExtraArgs</span> | None</code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>The <code>optax</code> optimiser to use during the update step.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>tolerance</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#float">float</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><code>tolerance</code> used when determining if a minimum has been found.</p>
              </div>
            </td>
            <td>
                  <code>1e-08</code>
            </td>
          </tr>
      </tbody>
    </table>


    <p><span class="doc-section-title">Returns:</span></p>
    <table>
      <thead>
        <tr>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="SolverResult


  
      dataclass
   (causalprog.solvers.solver_result.SolverResult)" href="#causalprog.solvers.solver_result.SolverResult">SolverResult</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Minimising argument of <code>obj_fn</code>.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="SolverResult


  
      dataclass
   (causalprog.solvers.solver_result.SolverResult)" href="#causalprog.solvers.solver_result.SolverResult">SolverResult</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Value of <code>obj_fn</code> at the minimum.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="SolverResult


  
      dataclass
   (causalprog.solvers.solver_result.SolverResult)" href="#causalprog.solvers.solver_result.SolverResult">SolverResult</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Gradient of <code>obj_fn</code> at the minimum.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                  <code><a class="autorefs autorefs-internal" title="SolverResult


  
      dataclass
   (causalprog.solvers.solver_result.SolverResult)" href="#causalprog.solvers.solver_result.SolverResult">SolverResult</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of iterations performed.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/causalprog/solvers/sgd.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">stochastic_gradient_descent</span><span class="p">(</span>
    <span class="n">obj_fn</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">PyTree</span><span class="p">],</span> <span class="n">npt</span><span class="o">.</span><span class="n">ArrayLike</span><span class="p">],</span>
    <span class="n">initial_guess</span><span class="p">:</span> <span class="n">PyTree</span><span class="p">,</span>
    <span class="o">*</span><span class="p">,</span>
    <span class="n">convergence_criteria</span><span class="p">:</span> <span class="n">Callable</span><span class="p">[[</span><span class="n">PyTree</span><span class="p">,</span> <span class="n">PyTree</span><span class="p">],</span> <span class="n">npt</span><span class="o">.</span><span class="n">ArrayLike</span><span class="p">]</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">fn_args</span><span class="p">:</span> <span class="nb">tuple</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">fn_kwargs</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">learning_rate</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0e-1</span><span class="p">,</span>
    <span class="n">maxiter</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1000</span><span class="p">,</span>
    <span class="n">optimiser</span><span class="p">:</span> <span class="n">optax</span><span class="o">.</span><span class="n">GradientTransformationExtraArgs</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">tolerance</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0e-8</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">SolverResult</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Minimise a function of one argument using Stochastic Gradient Descent (SGD).</span>

<span class="sd">    The `obj_fn` provided will be minimised over its first argument. If you wish to</span>
<span class="sd">    minimise a function over a different argument, or multiple arguments, wrap it in a</span>
<span class="sd">    suitable `lambda` expression that has the correct call signature. For example, to</span>
<span class="sd">    minimise a function `f(x, y, z)` over `y` and `z`, use</span>
<span class="sd">    `g = lambda yz, x: f(x, yz[0], yz[1])`, and pass `g` in as `obj_fn`. Note that</span>
<span class="sd">    you will also need to provide a constant value for `x` via `fn_args` or `fn_kwargs`.</span>

<span class="sd">    The `fn_args` and `fn_kwargs` keys can be used to supply additional parameters that</span>
<span class="sd">    need to be passed to `obj_fn`, but which should be held constant.</span>

<span class="sd">    SGD terminates when the `convergence_criteria` is found to be smaller than the</span>
<span class="sd">    `tolerance`. That is, when</span>
<span class="sd">    `convergence_criteria(objective_value, gradient_value) &lt;= tolerance` is found to</span>
<span class="sd">    be `True`, the algorithm considers a minimum to have been found. The default</span>
<span class="sd">    condition under which the algorithm terminates is when the norm of the gradient</span>
<span class="sd">    at the current argument value is smaller than the provided `tolerance`.</span>

<span class="sd">    The optimiser to use can be selected by passing in a suitable `optax` optimiser</span>
<span class="sd">    via the `optimiser` command. By default, `optax.adams` is used with the supplied</span>
<span class="sd">    `learning_rate`. Providing an explicit value for `optimiser` will result in the</span>
<span class="sd">    `learning_rate` argument being ignored.</span>

<span class="sd">    Args:</span>
<span class="sd">        obj_fn: Function to be minimised over its first argument.</span>
<span class="sd">        initial_guess: Initial guess for the minimising argument.</span>
<span class="sd">        convergence_criteria: The quantity that will be tested against `tolerance`, to</span>
<span class="sd">            determine whether the method has converged to a minimum. It should be a</span>
<span class="sd">            `callable` that takes the current value of `obj_fn` as its 1st argument, and</span>
<span class="sd">            the current value of the gradient of `obj_fn` as its 2nd argument. The</span>
<span class="sd">            default criteria is the l2-norm of the gradient.</span>
<span class="sd">        fn_args: Positional arguments to be passed to `obj_fn`, and held constant.</span>
<span class="sd">        fn_kwargs: Keyword arguments to be passed to `obj_fn`, and held constant.</span>
<span class="sd">        learning_rate: Default learning rate (or step size) to use when using the</span>
<span class="sd">            default `optimiser`. No effect if `optimiser` is provided explicitly.</span>
<span class="sd">        maxiter: Maximum number of iterations to perform. An error will be reported if</span>
<span class="sd">            this number of iterations is exceeded.</span>
<span class="sd">        optimiser: The `optax` optimiser to use during the update step.</span>
<span class="sd">        tolerance: `tolerance` used when determining if a minimum has been found.</span>

<span class="sd">    Returns:</span>
<span class="sd">        Minimising argument of `obj_fn`.</span>
<span class="sd">        Value of `obj_fn` at the minimum.</span>
<span class="sd">        Gradient of `obj_fn` at the minimum.</span>
<span class="sd">        Number of iterations performed.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">fn_args</span><span class="p">:</span>
        <span class="n">fn_args</span> <span class="o">=</span> <span class="p">()</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">fn_kwargs</span><span class="p">:</span>
        <span class="n">fn_kwargs</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">convergence_criteria</span><span class="p">:</span>
        <span class="n">convergence_criteria</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">_</span><span class="p">,</span> <span class="n">dx</span><span class="p">:</span> <span class="n">jnp</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">l2_normsq</span><span class="p">(</span><span class="n">dx</span><span class="p">))</span>  <span class="c1"># noqa: E731</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">optimiser</span><span class="p">:</span>
        <span class="n">optimiser</span> <span class="o">=</span> <span class="n">optax</span><span class="o">.</span><span class="n">adam</span><span class="p">(</span><span class="n">learning_rate</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">objective</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">ArrayLike</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">npt</span><span class="o">.</span><span class="n">ArrayLike</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">obj_fn</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="o">*</span><span class="n">fn_args</span><span class="p">,</span> <span class="o">**</span><span class="n">fn_kwargs</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">is_converged</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">ArrayLike</span><span class="p">,</span> <span class="n">dx</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">ArrayLike</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">convergence_criteria</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">dx</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">tolerance</span>

    <span class="n">converged</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="n">opt_state</span> <span class="o">=</span> <span class="n">optimiser</span><span class="o">.</span><span class="n">init</span><span class="p">(</span><span class="n">initial_guess</span><span class="p">)</span>
    <span class="n">current_params</span> <span class="o">=</span> <span class="n">deepcopy</span><span class="p">(</span><span class="n">initial_guess</span><span class="p">)</span>
    <span class="n">gradient</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">grad</span><span class="p">(</span><span class="n">objective</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">maxiter</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">objective_value</span> <span class="o">=</span> <span class="n">objective</span><span class="p">(</span><span class="n">current_params</span><span class="p">)</span>
        <span class="n">gradient_value</span> <span class="o">=</span> <span class="n">gradient</span><span class="p">(</span><span class="n">current_params</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">converged</span> <span class="o">:=</span> <span class="n">is_converged</span><span class="p">(</span><span class="n">objective_value</span><span class="p">,</span> <span class="n">gradient_value</span><span class="p">):</span>
            <span class="k">break</span>

        <span class="n">updates</span><span class="p">,</span> <span class="n">opt_state</span> <span class="o">=</span> <span class="n">optimiser</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">gradient_value</span><span class="p">,</span> <span class="n">opt_state</span><span class="p">)</span>
        <span class="n">current_params</span> <span class="o">=</span> <span class="n">optax</span><span class="o">.</span><span class="n">apply_updates</span><span class="p">(</span><span class="n">current_params</span><span class="p">,</span> <span class="n">updates</span><span class="p">)</span>

    <span class="n">iters_used</span> <span class="o">=</span> <span class="n">_</span>
    <span class="n">reason_msg</span> <span class="o">=</span> <span class="p">(</span>
        <span class="sa">f</span><span class="s2">&quot;Did not converge after </span><span class="si">{</span><span class="n">iters_used</span><span class="si">}</span><span class="s2"> iterations&quot;</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">converged</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">SolverResult</span><span class="p">(</span>
        <span class="n">fn_args</span><span class="o">=</span><span class="n">current_params</span><span class="p">,</span>
        <span class="n">grad_val</span><span class="o">=</span><span class="n">gradient_value</span><span class="p">,</span>
        <span class="n">iters</span><span class="o">=</span><span class="n">iters_used</span><span class="p">,</span>
        <span class="n">maxiter</span><span class="o">=</span><span class="n">maxiter</span><span class="p">,</span>
        <span class="n">obj_val</span><span class="o">=</span><span class="n">objective_value</span><span class="p">,</span>
        <span class="n">reason</span><span class="o">=</span><span class="n">reason_msg</span><span class="p">,</span>
        <span class="n">successful</span><span class="o">=</span><span class="n">converged</span><span class="p">,</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="causalprog.solvers.solver_result" class="doc doc-heading">
            <code>solver_result</code>


</h3>

    <div class="doc doc-contents ">

        <p>Container class for outputs from solver methods.</p>










  <div class="doc doc-children">









<div class="doc doc-object doc-class">



<h4 id="causalprog.solvers.solver_result.SolverResult" class="doc doc-heading">
            <code>SolverResult</code>


  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-dataclass"><code>dataclass</code></small>
  </span>

</h4>


    <div class="doc doc-contents ">


        <p>Container class for outputs from solver methods.</p>
<p>Instances of this class provide a container for useful information that
comes out of running one of the solver methods on a causal problem.</p>


<p><span class="doc-section-title">Attributes:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td><code><span title="causalprog.solvers.solver_result.SolverResult.fn_args">fn_args</span></code></td>
            <td>
                  <code><span title="causalprog.utils.norms.PyTree">PyTree</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Argument to the objective function at final iteration (the solution,
if <code>successful is</code>True`).</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="causalprog.solvers.solver_result.SolverResult.grad_val">grad_val</span></code></td>
            <td>
                  <code><span title="causalprog.utils.norms.PyTree">PyTree</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Value of the gradient of the objective function at the <code>fn_args</code>.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="causalprog.solvers.solver_result.SolverResult.iters">iters</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Number of iterations performed.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="causalprog.solvers.solver_result.SolverResult.maxiter">maxiter</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#int">int</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Maximum number of iterations the solver was permitted to perform.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="causalprog.solvers.solver_result.SolverResult.obj_val">obj_val</span></code></td>
            <td>
                  <code><span title="numpy.typing.ArrayLike">ArrayLike</span></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Value of the objective function at <code>fn_args</code>.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="causalprog.solvers.solver_result.SolverResult.reason">reason</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Human-readable string explaining success or reasons for solver failure.</p>
              </div>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td><code><span title="causalprog.solvers.solver_result.SolverResult.successful">successful</span></code></td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#bool">bool</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p><code>True</code> if solver converged, in which case <code>fn_args</code> is the
argument to the objective function at the solution of the problem being
solved. <code>False</code> otherwise.</p>
              </div>
            </td>
          </tr>
      </tbody>
    </table>








              <details class="quote">
                <summary>Source code in <code>src/causalprog/solvers/solver_result.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nd">@dataclass</span><span class="p">(</span><span class="n">frozen</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="k">class</span><span class="w"> </span><span class="nc">SolverResult</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Container class for outputs from solver methods.</span>

<span class="sd">    Instances of this class provide a container for useful information that</span>
<span class="sd">    comes out of running one of the solver methods on a causal problem.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        fn_args: Argument to the objective function at final iteration (the solution,</span>
<span class="sd">            if `successful is `True`).</span>
<span class="sd">        grad_val: Value of the gradient of the objective function at the `fn_args`.</span>
<span class="sd">        iters: Number of iterations performed.</span>
<span class="sd">        maxiter: Maximum number of iterations the solver was permitted to perform.</span>
<span class="sd">        obj_val: Value of the objective function at `fn_args`.</span>
<span class="sd">        reason: Human-readable string explaining success or reasons for solver failure.</span>
<span class="sd">        successful: `True` if solver converged, in which case `fn_args` is the</span>
<span class="sd">            argument to the objective function at the solution of the problem being</span>
<span class="sd">            solved. `False` otherwise.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">fn_args</span><span class="p">:</span> <span class="n">PyTree</span>
    <span class="n">grad_val</span><span class="p">:</span> <span class="n">PyTree</span>
    <span class="n">iters</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">maxiter</span><span class="p">:</span> <span class="nb">int</span>
    <span class="n">obj_val</span><span class="p">:</span> <span class="n">npt</span><span class="o">.</span><span class="n">ArrayLike</span>
    <span class="n">reason</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">successful</span><span class="p">:</span> <span class="nb">bool</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">












  </div>

    </div>

</div>




  </div>

    </div>

</div>


  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h2 id="causalprog.utils" class="doc doc-heading">
            <code>utils</code>


</h2>

    <div class="doc doc-contents ">

        <p>Utility classes and methods.</p>










  <div class="doc doc-children">











<div class="doc doc-object doc-module">



<h3 id="causalprog.utils.norms" class="doc doc-heading">
            <code>norms</code>


</h3>

    <div class="doc doc-contents ">

        <p>Misc collection of norm-like functions for PyTree structures.</p>










  <div class="doc doc-children">










<div class="doc doc-object doc-function">


<h4 id="causalprog.utils.norms.l2_normsq" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">l2_normsq</span><span class="p">(</span><span class="n">x</span><span class="p">)</span></code>

</h4>


    <div class="doc doc-contents ">

        <p>Square of the l2-norm of a PyTree.</p>
<p>This is effectively "sum(elements**2 in leaf for leaf in x)".</p>


            <details class="quote">
              <summary>Source code in <code>src/causalprog/utils/norms.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">l2_normsq</span><span class="p">(</span><span class="n">x</span><span class="p">:</span> <span class="n">PyTree</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">npt</span><span class="o">.</span><span class="n">ArrayLike</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Square of the l2-norm of a PyTree.</span>

<span class="sd">    This is effectively &quot;sum(elements**2 in leaf for leaf in x)&quot;.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">leaves</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">jax</span><span class="o">.</span><span class="n">tree_util</span><span class="o">.</span><span class="n">tree_flatten</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="k">return</span> <span class="nb">sum</span><span class="p">(</span><span class="n">jax</span><span class="o">.</span><span class="n">numpy</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">leaf</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="k">for</span> <span class="n">leaf</span> <span class="ow">in</span> <span class="n">leaves</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>

<div class="doc doc-object doc-module">



<h3 id="causalprog.utils.translator" class="doc doc-heading">
            <code>translator</code>


</h3>

    <div class="doc doc-contents ">

        <p>Helper class to keep the codebase backend-agnostic.</p>
<p>Our frontend (or user-facing) classes each use a syntax that applies across the package
codebase. By contrast, the various backends that we want to support will have different
syntaxes and call signatures for the functions that we want to support. As such, we need
a helper class that can store this "translation" information, allowing the user to
interact with the package in a standard way but also allowing them to choose their own
backend if desired.</p>










  <div class="doc doc-children">









<div class="doc doc-object doc-class">



<h4 id="causalprog.utils.translator.Translator" class="doc doc-heading">
            <code>Translator</code>


</h4>


    <div class="doc doc-contents ">
            <p class="doc doc-class-bases">
              Bases: <code><a class="autorefs autorefs-external" title="abc.ABC" href="https://docs.python.org/3/library/abc.html#abc.ABC">ABC</a></code></p>


        <p>Maps syntax of a backend function to our frontend syntax.</p>
<p>Different backends have different syntax for drawing samples from the distributions
they support. In order to map these different syntaxes to our backend-agnostic
framework, we need a container class to map the names we have chosen for our
frontend methods to those used by their corresponding backend method.</p>
<p>A <code>Translator</code> allows us to identify whether a user-provided backend object is
compatible with one of our frontend wrapper classes (and thus, call signatures). It
also allows users to write their own translators for any custom backends that we do
not explicitly support.</p>
<p>The use case for a <code>Translator</code> is as follows. Suppose that we have a frontend
class <code>C</code> that needs to provide a method <code>do_something</code>. <code>C</code> stores a
reference to a backend object <code>obj</code> that can provide the functionality of
<code>do_something</code> via one of its methods, <code>obj.backend_method</code>. However, there is
no guarantee that the signature of <code>do_something</code> maps identically to that of
<code>obj.backend_method</code>. A <code>Translator</code> allows us to encode a mapping of
<code>obj.backend_method</code>s arguments to those of <code>do_something</code>.</p>








              <details class="quote">
                <summary>Source code in <code>src/causalprog/utils/translator.py</code></summary>
                <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span><span class="w"> </span><span class="nc">Translator</span><span class="p">(</span><span class="n">ABC</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Maps syntax of a backend function to our frontend syntax.</span>

<span class="sd">    Different backends have different syntax for drawing samples from the distributions</span>
<span class="sd">    they support. In order to map these different syntaxes to our backend-agnostic</span>
<span class="sd">    framework, we need a container class to map the names we have chosen for our</span>
<span class="sd">    frontend methods to those used by their corresponding backend method.</span>

<span class="sd">    A ``Translator`` allows us to identify whether a user-provided backend object is</span>
<span class="sd">    compatible with one of our frontend wrapper classes (and thus, call signatures). It</span>
<span class="sd">    also allows users to write their own translators for any custom backends that we do</span>
<span class="sd">    not explicitly support.</span>

<span class="sd">    The use case for a ``Translator`` is as follows. Suppose that we have a frontend</span>
<span class="sd">    class ``C`` that needs to provide a method ``do_something``. ``C`` stores a</span>
<span class="sd">    reference to a backend object ``obj`` that can provide the functionality of</span>
<span class="sd">    ``do_something`` via one of its methods, ``obj.backend_method``. However, there is</span>
<span class="sd">    no guarantee that the signature of ``do_something`` maps identically to that of</span>
<span class="sd">    ``obj.backend_method``. A ``Translator`` allows us to encode a mapping of</span>
<span class="sd">    ``obj.backend_method``s arguments to those of ``do_something``.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">backend_method</span><span class="p">:</span> <span class="nb">str</span>
    <span class="n">corresponding_backend_arg</span><span class="p">:</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="nb">str</span><span class="p">]</span>

    <span class="nd">@property</span>
    <span class="nd">@abstractmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">_frontend_method</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Name of the frontend method that the backend is to be translated into.&quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="nd">@abstractmethod</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">compulsory_frontend_args</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">set</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Arguments that are required by the frontend function.&quot;&quot;&quot;</span>

    <span class="nd">@property</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">compulsory_backend_args</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">set</span><span class="p">[</span><span class="nb">str</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Arguments that are required to be taken by the backend function.&quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">corresponding_backend_arg</span><span class="p">[</span><span class="n">arg_name</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">arg_name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">compulsory_frontend_args</span>
        <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">backend_method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">front_args_to_back_args</span><span class="p">:</span> <span class="nb">str</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Create a new Translator.</span>

<span class="sd">        Args:</span>
<span class="sd">            backend_method (str): Name of the backend method that the instance</span>
<span class="sd">                translates.</span>
<span class="sd">            **front_args_to_back_args (str): Mapping of frontend argument names to the</span>
<span class="sd">                corresponding backend argument names.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Assume backend name is identical to frontend name if not provided explicitly</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">backend_method</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">backend_method</span> <span class="k">if</span> <span class="n">backend_method</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">_frontend_method</span>
        <span class="p">)</span>

        <span class="c1"># This should really be immutable after we fill defaults!</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">corresponding_backend_arg</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">front_args_to_back_args</span><span class="p">)</span>
        <span class="c1"># Assume compulsory frontend args that are not given translations</span>
        <span class="c1"># retain their name in the backend.</span>
        <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">compulsory_frontend_args</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">arg</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">corresponding_backend_arg</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">corresponding_backend_arg</span><span class="p">[</span><span class="n">arg</span><span class="p">]</span> <span class="o">=</span> <span class="n">arg</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">translate_args</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>  <span class="c1"># noqa: ANN401</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Translate frontend arguments (with values) to backend arguments.</span>

<span class="sd">        Essentially transforms frontend keyword arguments into their backend keyword</span>
<span class="sd">        arguments, preserving the value assigned to each argument.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">corresponding_backend_arg</span><span class="p">[</span><span class="n">arg_name</span><span class="p">]:</span> <span class="n">arg_value</span>
            <span class="k">for</span> <span class="n">arg_name</span><span class="p">,</span> <span class="n">arg_value</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
        <span class="p">}</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">validate_compatible</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Determine if ``obj`` provides a compatible backend method.</span>

<span class="sd">        ``obj`` must provide a callable whose name matches ``self.backend_method``,</span>
<span class="sd">        and the callable referenced must take arguments matching the names specified in</span>
<span class="sd">        ``self.compulsory_backend_args``.</span>

<span class="sd">        Args:</span>
<span class="sd">            obj (object): Object to check possesses a method that can be translated into</span>
<span class="sd">                frontend syntax.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Check that obj does provide a method of matching name</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">backend_method</span><span class="p">):</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">obj</span><span class="si">}</span><span class="s2"> has no method &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">backend_method</span><span class="si">}</span><span class="s2">&#39;.&quot;</span>
            <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">callable</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">backend_method</span><span class="p">)):</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">backend_method</span><span class="si">}</span><span class="s2">&#39; attribute of </span><span class="si">{</span><span class="n">obj</span><span class="si">}</span><span class="s2"> is not callable.&quot;</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

        <span class="c1"># Check that this method will be callable with the information given.</span>
        <span class="n">method_params</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">backend_method</span><span class="p">))</span><span class="o">.</span><span class="n">parameters</span>
        <span class="c1"># The arguments that will be passed are actually taken by the method.</span>
        <span class="k">for</span> <span class="n">compulsory_arg</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">compulsory_backend_args</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">compulsory_arg</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">method_params</span><span class="p">:</span>
                <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">backend_method</span><span class="si">}</span><span class="s2">&#39; does not &quot;</span>
                    <span class="sa">f</span><span class="s2">&quot;take argument &#39;</span><span class="si">{</span><span class="n">compulsory_arg</span><span class="si">}</span><span class="s2">&#39;.&quot;</span>
                <span class="p">)</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
        <span class="c1"># The method does not _require_ any additional arguments</span>
        <span class="n">method_requires</span> <span class="o">=</span> <span class="p">{</span>
            <span class="n">name</span> <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">method_params</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">p</span><span class="o">.</span><span class="n">default</span> <span class="ow">is</span> <span class="n">p</span><span class="o">.</span><span class="n">empty</span>
        <span class="p">}</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">method_requires</span><span class="o">.</span><span class="n">issubset</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">compulsory_backend_args</span><span class="p">):</span>
            <span class="n">args_not_accounted_for</span> <span class="o">=</span> <span class="n">method_requires</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">compulsory_backend_args</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">backend_method</span><span class="si">}</span><span class="s2">&#39; not provided compulsory arguments &quot;</span>
                <span class="s2">&quot;(missing &quot;</span> <span class="o">+</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">args_not_accounted_for</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span>
            <span class="p">)</span>
</code></pre></div></td></tr></table></div>
              </details>



  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">



<h5 id="causalprog.utils.translator.Translator.compulsory_backend_args" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">compulsory_backend_args</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h5>


    <div class="doc doc-contents ">

        <p>Arguments that are required to be taken by the backend function.</p>

    </div>

</div>

<div class="doc doc-object doc-attribute">



<h5 id="causalprog.utils.translator.Translator.compulsory_frontend_args" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">compulsory_frontend_args</span></code>

  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-abstractmethod"><code>abstractmethod</code></small>
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

</h5>


    <div class="doc doc-contents ">

        <p>Arguments that are required by the frontend function.</p>

    </div>

</div>




<div class="doc doc-object doc-function">


<h5 id="causalprog.utils.translator.Translator.__init__" class="doc doc-heading">
            <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">backend_method</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">front_args_to_back_args</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Create a new Translator.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>backend_method</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Name of the backend method that the instance
translates.</p>
              </div>
            </td>
            <td>
                  <code>None</code>
            </td>
          </tr>
          <tr class="doc-section-item">
            <td>
                <code>**front_args_to_back_args</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/stdtypes.html#str">str</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Mapping of frontend argument names to the
corresponding backend argument names.</p>
              </div>
            </td>
            <td>
                  <code>{}</code>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/causalprog/utils/translator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">backend_method</span><span class="p">:</span> <span class="nb">str</span> <span class="o">|</span> <span class="kc">None</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">front_args_to_back_args</span><span class="p">:</span> <span class="nb">str</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Create a new Translator.</span>

<span class="sd">    Args:</span>
<span class="sd">        backend_method (str): Name of the backend method that the instance</span>
<span class="sd">            translates.</span>
<span class="sd">        **front_args_to_back_args (str): Mapping of frontend argument names to the</span>
<span class="sd">            corresponding backend argument names.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Assume backend name is identical to frontend name if not provided explicitly</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">backend_method</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">backend_method</span> <span class="k">if</span> <span class="n">backend_method</span> <span class="k">else</span> <span class="bp">self</span><span class="o">.</span><span class="n">_frontend_method</span>
    <span class="p">)</span>

    <span class="c1"># This should really be immutable after we fill defaults!</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">corresponding_backend_arg</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">front_args_to_back_args</span><span class="p">)</span>
    <span class="c1"># Assume compulsory frontend args that are not given translations</span>
    <span class="c1"># retain their name in the backend.</span>
    <span class="k">for</span> <span class="n">arg</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">compulsory_frontend_args</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">arg</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">corresponding_backend_arg</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">corresponding_backend_arg</span><span class="p">[</span><span class="n">arg</span><span class="p">]</span> <span class="o">=</span> <span class="n">arg</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="causalprog.utils.translator.Translator.translate_args" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">translate_args</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Translate frontend arguments (with values) to backend arguments.</p>
<p>Essentially transforms frontend keyword arguments into their backend keyword
arguments, preserving the value assigned to each argument.</p>


            <details class="quote">
              <summary>Source code in <code>src/causalprog/utils/translator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span>
<span class="normal">97</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">translate_args</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">:</span> <span class="n">Any</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">Any</span><span class="p">]:</span>  <span class="c1"># noqa: ANN401</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Translate frontend arguments (with values) to backend arguments.</span>

<span class="sd">    Essentially transforms frontend keyword arguments into their backend keyword</span>
<span class="sd">    arguments, preserving the value assigned to each argument.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">corresponding_backend_arg</span><span class="p">[</span><span class="n">arg_name</span><span class="p">]:</span> <span class="n">arg_value</span>
        <span class="k">for</span> <span class="n">arg_name</span><span class="p">,</span> <span class="n">arg_value</span> <span class="ow">in</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
    <span class="p">}</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>

<div class="doc doc-object doc-function">


<h5 id="causalprog.utils.translator.Translator.validate_compatible" class="doc doc-heading">
            <code class="highlight language-python"><span class="n">validate_compatible</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span></code>

</h5>


    <div class="doc doc-contents ">

        <p>Determine if <code>obj</code> provides a compatible backend method.</p>
<p><code>obj</code> must provide a callable whose name matches <code>self.backend_method</code>,
and the callable referenced must take arguments matching the names specified in
<code>self.compulsory_backend_args</code>.</p>


<p><span class="doc-section-title">Parameters:</span></p>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Type</th>
          <th>Description</th>
          <th>Default</th>
        </tr>
      </thead>
      <tbody>
          <tr class="doc-section-item">
            <td>
                <code>obj</code>
            </td>
            <td>
                  <code><a class="autorefs autorefs-external" href="https://docs.python.org/3/library/functions.html#object">object</a></code>
            </td>
            <td>
              <div class="doc-md-description">
                <p>Object to check possesses a method that can be translated into
frontend syntax.</p>
              </div>
            </td>
            <td>
                <em>required</em>
            </td>
          </tr>
      </tbody>
    </table>


            <details class="quote">
              <summary>Source code in <code>src/causalprog/utils/translator.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">validate_compatible</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">obj</span><span class="p">:</span> <span class="nb">object</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Determine if ``obj`` provides a compatible backend method.</span>

<span class="sd">    ``obj`` must provide a callable whose name matches ``self.backend_method``,</span>
<span class="sd">    and the callable referenced must take arguments matching the names specified in</span>
<span class="sd">    ``self.compulsory_backend_args``.</span>

<span class="sd">    Args:</span>
<span class="sd">        obj (object): Object to check possesses a method that can be translated into</span>
<span class="sd">            frontend syntax.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Check that obj does provide a method of matching name</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">backend_method</span><span class="p">):</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">obj</span><span class="si">}</span><span class="s2"> has no method &#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">backend_method</span><span class="si">}</span><span class="s2">&#39;.&quot;</span>
        <span class="k">raise</span> <span class="ne">AttributeError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="nb">callable</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">backend_method</span><span class="p">)):</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">backend_method</span><span class="si">}</span><span class="s2">&#39; attribute of </span><span class="si">{</span><span class="n">obj</span><span class="si">}</span><span class="s2"> is not callable.&quot;</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>

    <span class="c1"># Check that this method will be callable with the information given.</span>
    <span class="n">method_params</span> <span class="o">=</span> <span class="n">inspect</span><span class="o">.</span><span class="n">signature</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">backend_method</span><span class="p">))</span><span class="o">.</span><span class="n">parameters</span>
    <span class="c1"># The arguments that will be passed are actually taken by the method.</span>
    <span class="k">for</span> <span class="n">compulsory_arg</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">compulsory_backend_args</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">compulsory_arg</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">method_params</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">backend_method</span><span class="si">}</span><span class="s2">&#39; does not &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;take argument &#39;</span><span class="si">{</span><span class="n">compulsory_arg</span><span class="si">}</span><span class="s2">&#39;.&quot;</span>
            <span class="p">)</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span>
    <span class="c1"># The method does not _require_ any additional arguments</span>
    <span class="n">method_requires</span> <span class="o">=</span> <span class="p">{</span>
        <span class="n">name</span> <span class="k">for</span> <span class="n">name</span><span class="p">,</span> <span class="n">p</span> <span class="ow">in</span> <span class="n">method_params</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">p</span><span class="o">.</span><span class="n">default</span> <span class="ow">is</span> <span class="n">p</span><span class="o">.</span><span class="n">empty</span>
    <span class="p">}</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">method_requires</span><span class="o">.</span><span class="n">issubset</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">compulsory_backend_args</span><span class="p">):</span>
        <span class="n">args_not_accounted_for</span> <span class="o">=</span> <span class="n">method_requires</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">compulsory_backend_args</span>
        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">backend_method</span><span class="si">}</span><span class="s2">&#39; not provided compulsory arguments &quot;</span>
            <span class="s2">&quot;(missing &quot;</span> <span class="o">+</span> <span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">args_not_accounted_for</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;)&quot;</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>
    </div>

</div>



  </div>

    </div>

</div>




  </div>

    </div>

</div>


  </div>

    </div>

</div>


  </div>

    </div>

</div>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright © 2025 University College London - <a href="#__consent">Change cookie settings</a>

    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/UCL" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
      <div class="md-consent" data-md-component="consent" id="__consent" hidden>
        <div class="md-consent__overlay"></div>
        <aside class="md-consent__inner">
          <form class="md-consent__form md-grid md-typeset" name="consent">
            



<h4>Cookie consent</h4>
<p>We use cookies to recognize your repeated visits and preferences, as well as to measure the effectiveness of our documentation and whether users find what they're searching for. With your consent, you're helping us to make our documentation better.</p>
<input class="md-toggle" type="checkbox" id="__settings" >
<div class="md-consent__settings">
  <ul class="task-list">
    
    
      
    
    
      
        
  
  
    
    
  
  <li class="task-list-item">
    <label class="task-list-control">
      <input type="checkbox" name="github" checked>
      <span class="task-list-indicator"></span>
      GitHub
    </label>
  </li>

      
    
    
  </ul>
</div>
<div class="md-consent__controls">
  
    
    
      <button type="reset" class="md-button md-button--primary">Reject</button>
    
    
  
    
    
    
      <label class="md-button" for="__settings">Manage settings</label>
    
  
    
      <button class="md-button md-button--primary">Accept</button>
    
    
    
  
</div>
          </form>
        </aside>
      </div>
      <script>var consent=__md_get("__consent");if(consent)for(var input of document.forms.consent.elements)input.name&&(input.checked=consent[input.name]||!1);else"file:"!==location.protocol&&setTimeout((function(){document.querySelector("[data-md-component=consent]").hidden=!1}),250);var form=document.forms.consent;for(var action of["submit","reset"])form.addEventListener(action,(function(e){if(e.preventDefault(),"reset"===e.type)for(var n of document.forms.consent.elements)n.name&&(n.checked=!1);__md_set("__consent",Object.fromEntries(Array.from(new FormData(form).keys()).map((function(e){return[e,!0]})))),location.hash="",location.reload()}))</script>
    
    
      
      <script id="__config" type="application/json">{"base": "..", "features": ["content.action.edit"], "search": "../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
        <script src="../javascripts/mathjax.js"></script>
      
        <script src="https://unpkg.com/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>